var graph=function(){"use strict";var e,i,n,u,l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s={},h={},o={},d=s["util.base"]={browser:{webkit:"WebkitAppearance"in document.documentElement.style,mozilla:void 0!==window.mozInnerScreenX,msie:-1!=window.navigator.userAgent.indexOf("Trident")},isTouch:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(window.navigator.userAgent),inherit:function(t,e){this.typeCheck("function",t)&&this.typeCheck("function",e)&&(t.parent=e,t.prototype=new e,(t.prototype.constructor=t).prototype.parent=t.prototype,t.prototype.super=function(t,e){return this.constructor.prototype[t].apply(this,e)})},extend:function(t,e,i){if(this.typeCheck(["object","function"],t)||(t={}),!this.typeCheck(["object","function"],e))return t;for(var n in e)!0===i?r(t[n])?this.extend(t[n],e[n],i):this.typeCheck("undefined",t[n])&&(t[n]=e[n]):r(t[n])?this.extend(t[n],e[n],i):t[n]=e[n];function r(t){return d.typeCheck("object",t)}return t},pxToInt:function(t){return this.typeCheck("string",t)&&-1!=t.indexOf("px")?parseInt(t.split("px").join("")):t},clone:function(t){var e=this.typeCheck("array",t)?[]:{};for(var i in t)this.typeCheck("object",t[i])?e[i]=this.clone(t[i]):e[i]=t[i];return e},deepClone:function(t,e){var i=null;if(e=e||{},this.typeCheck("array",t)){i=new Array(t.length);for(var n=0,r=t.length;n<r;n++)i[n]=this.deepClone(t[n],e)}else if(this.typeCheck("date",t))i=t;else if(this.typeCheck("object",t))for(var a in i={},t)e[a]?i[a]=t[a]:i[a]=this.deepClone(t[a],e);else i=t;return i},runtime:function(t,e){var i=(new Date).getTime();e();var n=(new Date).getTime();console.warn(t+" : "+(n-i)+"ms")},resize:function(t,e){var i,n=(i=0,function(){clearTimeout(i),i=setTimeout(t,e)});window.addEventListener?window.addEventListener("resize",n):object.attachEvent?window.attachEvent("onresize",n):window.onresize=n},typeCheck:function(t,e){function i(t,e){return"string"==typeof t&&("string"==t?"string"==typeof e:"integer"==t?"number"==typeof e&&e%1==0:"float"==t?"number"==typeof e&&e%1!=0:"number"==t?"number"==typeof e:"boolean"==t?"boolean"==typeof e:"undefined"==t?void 0===e:"null"==t?null===e:"array"==t?e instanceof Array:"date"==t?e instanceof Date:"function"==t?"function"==typeof e:"object"==t&&!("object"!=(void 0===e?"undefined":l(e))||null===e||e instanceof Array||e instanceof Date||e instanceof RegExp))}if("object"==(void 0===t?"undefined":l(t))&&t.length){for(var n=t,r=0;r<n.length;r++)if(i(n[r],e))return!0;return!1}return i(t,e)},typeCheckObj:function(t,a){if("object"==(void 0===t?"undefined":l(t))){var s=this;for(var e in t){var i=t[e];"function"==typeof i&&function(n,r){t[n]=function(){for(var t=arguments,e=a[n],i=0;i<t.length;i++)if(!s.typeCheck(e[i],t[i]))throw new Error("JUI_CRITICAL_ERR: the "+i+"th parameter is not a "+e[i]+" ("+name+")");return r.apply(this,t)}}(e,i)}}},dateFormat:function(t,e,i){var n=["\0","January","February","March","April","May","June","July","August","September","October","November","December"],r=["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],a=["","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s=["","Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function h(t,e){var i=t+"";for(e=e||2;i.length<e;)i="0"+i;return i}var o=i?t.getUTCFullYear():t.getFullYear();e=(e=(e=e.replace(/(^|[^\\])yyyy+/g,"$1"+o)).replace(/(^|[^\\])yy/g,"$1"+o.toString().substr(2,2))).replace(/(^|[^\\])y/g,"$1"+o);var c=(i?t.getUTCMonth():t.getMonth())+1;e=(e=(e=(e=e.replace(/(^|[^\\])MMMM+/g,"$1"+n[0])).replace(/(^|[^\\])MMM/g,"$1"+r[0])).replace(/(^|[^\\])MM/g,"$1"+h(c))).replace(/(^|[^\\])M/g,"$1"+c);var u=i?t.getUTCDate():t.getDate();e=(e=(e=(e=e.replace(/(^|[^\\])dddd+/g,"$1"+a[0])).replace(/(^|[^\\])ddd/g,"$1"+s[0])).replace(/(^|[^\\])dd/g,"$1"+h(u))).replace(/(^|[^\\])d/g,"$1"+u);var l=i?t.getUTCHours():t.getHours(),d=12<l?l-12:0==l?12:l;e=(e=(e=(e=e.replace(/(^|[^\\])HH+/g,"$1"+h(l))).replace(/(^|[^\\])H/g,"$1"+l)).replace(/(^|[^\\])hh+/g,"$1"+h(d))).replace(/(^|[^\\])h/g,"$1"+d);var f=i?t.getUTCMinutes():t.getMinutes();e=(e=e.replace(/(^|[^\\])mm+/g,"$1"+h(f))).replace(/(^|[^\\])m/g,"$1"+f);var p=i?t.getUTCSeconds():t.getSeconds();e=(e=e.replace(/(^|[^\\])ss+/g,"$1"+h(p))).replace(/(^|[^\\])s/g,"$1"+p);var g=i?t.getUTCMilliseconds():t.getMilliseconds();e=e.replace(/(^|[^\\])fff+/g,"$1"+h(g,3)),g=Math.round(g/10),e=e.replace(/(^|[^\\])ff/g,"$1"+h(g)),g=Math.round(g/10);var m=l<12?"AM":"PM";e=(e=(e=e.replace(/(^|[^\\])f/g,"$1"+g)).replace(/(^|[^\\])TT+/g,"$1"+m)).replace(/(^|[^\\])T/g,"$1"+m.charAt(0));var v=m.toLowerCase();e=(e=e.replace(/(^|[^\\])tt+/g,"$1"+v)).replace(/(^|[^\\])t/g,"$1"+v.charAt(0));var y=-t.getTimezoneOffset(),x=i||!y?"Z":0<y?"+":"-";if(!i){var w=(y=Math.abs(y))%60;x+=h(Math.floor(y/60))+":"+h(w)}e=e.replace(/(^|[^\\])K/g,"$1"+x);var b=(i?t.getUTCDay():t.getDay())+1;return e=(e=(e=(e=(e=e.replace(new RegExp(a[0],"g"),a[b])).replace(new RegExp(s[0],"g"),s[b])).replace(new RegExp(n[0],"g"),n[c])).replace(new RegExp(r[0],"g"),r[c])).replace(/\\(.)/g,"$1")},createId:function(t){return[t||"id",+new Date,Math.round(100*Math.random())%100].join("-")},timeLoop:function(t,r){return function(i,n){!function t(e){e<1||(1==e?(i.call(r,e),n.call(r)):setTimeout(function(){-1<e&&i.call(r,e--),-1<e&&t(e)},1))}(t)}},loop:function(t,l){var d=t,f=Math.ceil(t/5);return function(t){for(var e=0,i=1*f,n=2*f,r=3*f,a=4*f,s=i,h=n,o=r,c=a,u=d;e<s&&e<d;)t.call(l,e,1),e++,i<h&&i<d&&(t.call(l,i,2),i++),n<o&&n<d&&(t.call(l,n,3),n++),r<c&&r<d&&(t.call(l,r,4),r++),a<u&&a<d&&(t.call(l,a,5),a++)}},loopArray:function(l,d){var t=l.length,f=t,p=Math.ceil(t/5);return function(t){for(var e=0,i=1*p,n=2*p,r=3*p,a=4*p,s=i,h=n,o=r,c=a,u=f;e<s&&e<f;)t.call(d,l[e],e,1),e++,i<h&&i<f&&(t.call(d,l[i],i,2),i++),n<o&&n<f&&(t.call(d,l[n],n,3),n++),r<c&&r<f&&(t.call(d,l[r],r,4),r++),a<u&&a<f&&(t.call(d,l[a],a,5),a++)}},startsWith:function(t,e,i){return i=i||0,t.lastIndexOf(e,i)===i},endsWith:function(t,e,i){var n=t;(void 0===i||i>n.length)&&(i=n.length),i-=e.length;var r=n.indexOf(e,i);return-1!==r&&r===i},inArray:function(t,e){if(this.typeCheck(["undefined","null"],t)||!this.typeCheck("array",e))return-1;for(var i=0,n=e.length;i<n;i++)if(e[i]==t)return i;return-1},trim:function(t){var e="[\\x20\\t\\r\\n\\f]",i=new RegExp("^"+e+"+|((?:^|[^\\\\])(?:\\\\.)*)"+e+"+$","g");return null==t?"":(t+"").replace(i,"")},param:function(t){var e,i,n=[];for(var r in t)i=t[e=r],i=d.typeCheck("function",i)?i():null==i?"":i,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(i);return n.join("&").replace(/%20/g,"+")},ajax:function(t){var e=null,i="",n=null,r=d.extend({url:null,type:"GET",data:null,async:!0,success:null,fail:null},t);if(this.typeCheck("string",r.url)&&this.typeCheck("function",r.success)){if(this.typeCheck("object",r.data)&&(i=this.param(r.data)),this.typeCheck("undefined",XMLHttpRequest))for(var a=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],s=0,h=a.length;s<h;s++)try{e=new ActiveXObject(a[s]);break}catch(t){}else e=new XMLHttpRequest;null!=e&&(e.open(r.type,r.url,r.async),e.send(i),n=function(){4===e.readyState&&200==e.status?r.success(e):d.typeCheck("function",r.fail)&&r.fail(e)},r.async?e.onreadystatechange=n:n())}},ready:(n={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},u={isReady:!1,readyWait:1,holdReady:function(t){t?u.readyWait++:u.ready(!0)},ready:function(t){if(!0===t&&!--u.readyWait||!0!==t&&!u.isReady){if(!document.body)return setTimeout(u.ready,1);if((u.isReady=!0)!==t&&0<--u.readyWait)return;e.resolveWith(document,[u])}},bindReady:function(){if(!e){if(e=u._Deferred(),"complete"===document.readyState)return setTimeout(u.ready,1);if(document.addEventListener)document.addEventListener("DOMContentLoaded",i,!1),window.addEventListener("load",u.ready,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",i),window.attachEvent("onload",u.ready);var t=!1;try{t=null==window.frameElement}catch(t){}document.documentElement.doScroll&&t&&r()}}},_Deferred:function(){var s,i,h,o=[],c={done:function(){if(!h){var t,e,i,n,r,a=arguments;for(s&&(r=s,s=0),t=0,e=a.length;t<e;t++)i=a[t],"array"===(n=u.type(i))?c.done.apply(c,i):"function"===n&&o.push(i);r&&c.resolveWith(r[0],r[1])}return this},resolveWith:function(t,e){if(!h&&!s&&!i){e=e||[],i=1;try{for(;o[0];)o.shift().apply(t,e)}finally{s=[t,e],i=0}}return this},resolve:function(){return c.resolveWith(this,arguments),this},isResolved:function(){return!(!i&&!s)},cancel:function(){return h=1,o=[],this}};return c},type:function(t){return null==t?String(t):n[Object.prototype.toString.call(t)]||"object"}},document.addEventListener?i=function(){document.removeEventListener("DOMContentLoaded",i,!1),u.ready()}:document.attachEvent&&(i=function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",i),u.ready())}),function(t){u.bindReady(),u.type(t),e.done(t)})};function r(){if(!u.isReady){try{document.documentElement.doScroll("left")}catch(t){return void setTimeout(r,1)}u.ready()}}function c(t){for(var e=[],i=0;i<t.length;i++){var n=s[t[i]];if(d.typeCheck(["function","object"],n))e.push(n);else{var r=a(t[i]);null==r?(console.warn("JUI_WARNING_MSG: '"+t[i]+"' is not loaded"),e.push(null)):e.push(r)}}return e}var a=function(t){var e=null;t+=".";for(var i in s)if(-1!=i.indexOf(t)&&d.typeCheck(["function","object"],s[i])){var n=i.split(t).join("");-1==n.indexOf(".")&&(null==e&&(e={}),e[n]=s[i])}return e},z={ready:function(t,e){var i=[],n=2==arguments.length?e:t,r=2==arguments.length?t:null;if(!d.typeCheck(["array","null"],r)||!d.typeCheck("function",n))throw new Error("JUI_CRITICAL_ERR: Invalid parameter type of the function");d.ready(function(){r&&(i=c(r)),n.apply(null,i)})},defineUI:function(t,e,i,n){if(!(d.typeCheck("string",t)&&d.typeCheck("array",e)&&d.typeCheck("function",i)&&d.typeCheck(["string","undefined"],n)))throw new Error("JUI_CRITICAL_ERR: Invalid parameter type of the function");if(d.typeCheck("function",o[t]))throw new Error("JUI_CRITICAL_ERR: '"+t+"' is already exist");if(d.typeCheck("undefined",n)&&(n="core"),!d.typeCheck("function",o[n]))throw new Error("JUI_CRITICAL_ERR: Parents are the only function");if(!0!==h[n])throw new Error("JUI_CRITICAL_ERR: UI function can not be inherited");var r=c(e),a=i.apply(null,r);d.inherit(a,o[n]),s[t]=o[n].init({type:t,class:a}),o[t]=a,h[t]=!0},redefineUI:function(t,e,i,n,r){r||!0!==h[t]||(s[t]=null,o[t]=null,h[t]=!1),(!r||r&&!0!==h[t])&&this.defineUI(t,e,i,n)},createUIObject:function(t,e,i,n,r,a){var s=new t.class,h=z.defineOptions(t.class,r||{});(s.init.prototype=s).init.prototype.selector=e,s.init.prototype.root=n,s.init.prototype.options=h,s.init.prototype.event=new Array,s.init.prototype.timestamp=(new Date).getTime(),s.init.prototype.index=i,s.init.prototype.module=t,d.typeCheck("function",a)&&a(s,h);var o=new s.init;for(var c in h.event)o.on(c,h.event[c]);return n.jui=o},define:function(t,e,i,n){if(!(d.typeCheck("string",t)&&d.typeCheck("array",e)&&d.typeCheck("function",i)&&d.typeCheck(["string","undefined","null"],n)))throw new Error("JUI_CRITICAL_ERR: Invalid parameter type of the function");if(d.typeCheck("function",o[t]))throw new Error("JUI_CRITICAL_ERR: '"+t+"' is already exist");var r=c(e),a=i.apply(null,r);if(d.typeCheck("function",o[n])){if(!0!==h[n])throw new Error("JUI_CRITICAL_ERR: UI function can not be inherited");d.inherit(a,o[n])}s[t]=a,o[t]=a,h[t]=!0},redefine:function(t,e,i,n,r){r||!0!==h[t]||(s[t]=null,o[t]=null,h[t]=!1),(!r||r&&!0!==h[t])&&this.define(t,e,i,n)},defineOptions:function(t,e,i){for(var n=function t(e,i){if(d.typeCheck("function",e)){if(d.typeCheck("function",e.setup)){var n=e.setup();for(var r in n)d.typeCheck("undefined",i[r])&&(i[r]=n[r])}t(e.parent,i)}return i}(t,{}),r=Object.keys(n),a=Object.keys(e),s=0;s<a.length;s++){var h=a[s];if(-1==d.inArray(h,r)&&-1==d.inArray(h,i))throw new Error("JUI_CRITICAL_ERR: '"+h+"' is not an option")}return d.extend(e,n,!0),e},include:function(t){if(!d.typeCheck("string",t))throw new Error("JUI_CRITICAL_ERR: Invalid parameter type of the function");var e=s[t];if(d.typeCheck(["function","object"],e))return e;var i=a(t);return null==i?(console.warn("JUI_WARNING_MSG: '"+t+"' is not loaded"),null):i},includeAll:function(){var t=[];for(var e in s)t.push(s[e]);return t},use:function(){for(var t=[],e=0;e<arguments.length;e++)if(d.typeCheck("array",arguments[e]))for(var i=arguments[e],n=0;n<i.length;n++)d.typeCheck("object",i[n])&&t.push(i[n]);else d.typeCheck("object",arguments[e])&&t.push(arguments[e]);for(e=0;e<t.length;e++){var r=t[e];if("object"==(void 0===r?"undefined":l(r))){if("string"!=typeof r.name)return;if("function"!=typeof r.component)return;null!=r.extend&&null==z.include(r.extend)&&console.warn("JUI_WARNING_MSG: '"+r.extend+"' module should be imported in first"),"core"==r.extend?z.redefineUI(r.name,[],r.component,r.extend):z.redefine(r.name,[],r.component,r.extend)}}}},t={name:"util.dom",extend:null,component:function(){var a=z.include("util.base");return{find:function(){var t=arguments;if(1==t.length){if(a.typeCheck("string",t[0]))return document.querySelectorAll(t[0])}else if(2==t.length&&a.typeCheck("object",t[0])&&a.typeCheck("string",t[1]))return t[0].querySelectorAll(t[1]);return[]},each:function(t,i){if(a.typeCheck("function",i)){var e=null;a.typeCheck("string",t)?e=document.querySelectorAll(t):a.typeCheck("array",t)&&(e=t),null!=e&&Array.prototype.forEach.call(e,function(t,e){i.apply(t,[e,t])})}},attr:function(t,e){if(a.typeCheck(["string","array"],t)){var i=document.querySelectorAll(t);if(a.typeCheck("object",e))for(var n=0;n<i.length;n++)for(var r in e)i[n].setAttribute(r,e[r]);else if(a.typeCheck("string",e)&&0<i.length)return i[0].getAttribute(e)}},remove:function(t){this.each(t,function(){this.parentNode.removeChild(this)})},offset:function(t){var e,i,n={top:0,left:0},r=t&&t.ownerDocument;if(r){e=r.documentElement;var a,s;return"undefined"!==l(t.getBoundingClientRect)&&(n=t.getBoundingClientRect()),i=null!=(a=s=r)&&a==a.window?s:9===s.nodeType&&(s.defaultView||s.parentWindow),{top:n.top+(i.pageYOffset||e.scrollTop)-(e.clientTop||0),left:n.left+(i.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}}}}}},f={name:"util.math",extend:null,component:function(){var i=z.include("util.base");function c(t,e){for(var i=[],n=0,r=t.length;n<r;n++){for(var a=0,s=0,h=t[n].length;s<h;s++)a+=t[n][s]*e[s];i.push(a)}return i}return{rotate:function(t,e,i){return{x:t*Math.cos(i)-e*Math.sin(i),y:t*Math.sin(i)+e*Math.cos(i)}},resize:function(t,e,i,n){var r=n/i;return t<=i&&r<=1?(i=t,n=e*r):e<=n&&(n=e,i=t/r),{width:i,height:n}},radian:function(t){return t*Math.PI/180},degree:function(t){return 180*t/Math.PI},angle:function(t,e,i,n){var r=i-t,a=n-e;return Math.atan2(a,r)},interpolateNumber:function(e,t){var i=t-e;return function(t){return e+i*t}},interpolateRound:function(e,t){var i=t-e;return function(t){return Math.round(e+i*t)}},getFixed:function(t,e){var i=(t+"").split("."),n=i.length<2?0:i[1].length,r=(e+"").split("."),a=r.length<2?0:r[1].length;return a<n?n:a},fixed:function(t){function e(t){return Math.round(t*r)/r}var i=this.getFixed(t,0),r=Math.pow(10,i);return e.plus=function(t,e){return Math.round(t*r+e*r)/r},e.minus=function(t,e){return Math.round(t*r-e*r)/r},e.multi=function(t,e){return Math.round(t*r*(e*r))/(r*r)},e.div=function(t,e){var i=t*r/(e*r),n=Math.pow(10,this.getFixed(i,0));return Math.round(i*n)/n},e.remain=function(t,e){return Math.round(t*r%(e*r))/r},e},round:function(t,e){var i=Math.pow(10,e);return Math.round(t*i)/i},plus:function(t,e){var i=Math.pow(10,this.getFixed(t,e));return Math.round(t*i+e*i)/i},minus:function(t,e){var i=Math.pow(10,this.getFixed(t,e));return Math.round(t*i-e*i)/i},multi:function(t,e){var i=Math.pow(10,this.getFixed(t,e));return Math.round(t*i*(e*i))/(i*i)},div:function(t,e){var i=Math.pow(10,this.getFixed(t,e)),n=t*i/(e*i),r=Math.pow(10,this.getFixed(n,0));return Math.round(n*r)/r},remain:function(t,e){var i=Math.pow(10,this.getFixed(t,e));return Math.round(t*i%(e*i))/i},nice:function(t,e,i,n){if(e<t)var r=t,a=e;else a=t,r=e;var s,h,o=i,c=0,u=[];function l(t,e){var i=Math.floor(Math.log(t)/Math.LN10),n=t/Math.pow(10,i);return niceFraction=e?n<1.5?1:n<3?2:n<7?5:10:n<=1?1:n<=2?2:n<=5?5:10,niceFraction*Math.pow(10,i)}return u=(n=n||!1)?l(r-a,!1):r-a,c=n?l(u/o,!0):u/o,s=n?Math.floor(a/c)*c:a,h=n?Math.floor(r/c)*c:r,{min:s,max:h,range:u,spacing:c}},matrix:function(t,e){return i.typeCheck("array",e[0])?function(t,e){for(var i=[],n=[],r=0,a=e.length;r<a;r++)i[r]=[],n[r]=[];for(r=0,a=e.length;r<a;r++)for(var s=0,h=e[r].length;s<h;s++)i[s].push(e[r][s]);for(r=0,a=i.length;r<a;r++){var o=c(t,i[r]);for(s=0,h=o.length;s<h;s++)n[s].push(o[s])}return n}(t,e):c(t,e)},matrix3d:function(t,e){return e[0]instanceof Array||e[0]instanceof Float32Array?function(t,e){var i=[new Float32Array(4),new Float32Array(4),new Float32Array(4),new Float32Array(4)],n=[new Float32Array([e[0][0],e[1][0],e[2][0],e[3][0]]),new Float32Array([e[0][1],e[1][1],e[2][1],e[3][1]]),new Float32Array([e[0][2],e[1][2],e[2][2],e[3][2]]),new Float32Array([e[0][3],e[1][3],e[2][3],e[3][3]])];return i[0][0]=t[0][0]*n[0][0]+t[0][1]*n[0][1]+t[0][2]*n[0][2]+t[0][3]*n[0][3],i[1][0]=t[1][0]*n[0][0]+t[1][1]*n[0][1]+t[1][2]*n[0][2]+t[1][3]*n[0][3],i[2][0]=t[2][0]*n[0][0]+t[2][1]*n[0][1]+t[2][2]*n[0][2]+t[2][3]*n[0][3],i[3][0]=t[3][0]*n[0][0]+t[3][1]*n[0][1]+t[3][2]*n[0][2]+t[3][3]*n[0][3],i[0][1]=t[0][0]*n[1][0]+t[0][1]*n[1][1]+t[0][2]*n[1][2]+t[0][3]*n[1][3],i[1][1]=t[1][0]*n[1][0]+t[1][1]*n[1][1]+t[1][2]*n[1][2]+t[1][3]*n[1][3],i[2][1]=t[2][0]*n[1][0]+t[2][1]*n[1][1]+t[2][2]*n[1][2]+t[2][3]*n[1][3],i[3][1]=t[3][0]*n[1][0]+t[3][1]*n[1][1]+t[3][2]*n[1][2]+t[3][3]*n[1][3],i[0][2]=t[0][0]*n[2][0]+t[0][1]*n[2][1]+t[0][2]*n[2][2]+t[0][3]*n[2][3],i[1][2]=t[1][0]*n[2][0]+t[1][1]*n[2][1]+t[1][2]*n[2][2]+t[1][3]*n[2][3],i[2][2]=t[2][0]*n[2][0]+t[2][1]*n[2][1]+t[2][2]*n[2][2]+t[2][3]*n[2][3],i[3][2]=t[3][0]*n[2][0]+t[3][1]*n[2][1]+t[3][2]*n[2][2]+t[3][3]*n[2][3],i[0][3]=t[0][0]*n[3][0]+t[0][1]*n[3][1]+t[0][2]*n[3][2]+t[0][3]*n[3][3],i[1][3]=t[1][0]*n[3][0]+t[1][1]*n[3][1]+t[1][2]*n[3][2]+t[1][3]*n[3][3],i[2][3]=t[2][0]*n[3][0]+t[2][1]*n[3][1]+t[2][2]*n[3][2]+t[2][3]*n[3][3],i[3][3]=t[3][0]*n[3][0]+t[3][1]*n[3][1]+t[3][2]*n[3][2]+t[3][3]*n[3][3],i}(t,e):function(t,e){var i=new Float32Array(4);return i[0]=t[0][0]*e[0]+t[0][1]*e[1]+t[0][2]*e[2]+t[0][3]*e[3],i[1]=t[1][0]*e[0]+t[1][1]*e[1]+t[1][2]*e[2]+t[1][3]*e[3],i[2]=t[2][0]*e[0]+t[2][1]*e[1]+t[2][2]*e[2]+t[2][3]*e[3],i[3]=t[3][0]*e[0]+t[3][1]*e[1]+t[3][2]*e[2]+t[3][3]*e[3],i}(t,e)},inverseMatrix3d:function(t){return function(t){var e=[new Float32Array(4),new Float32Array(4),new Float32Array(4),new Float32Array(4)],i=t[0][0],n=t[0][1],r=t[0][2],a=t[0][3],s=t[1][0],h=t[1][1],o=t[1][2],c=t[1][3],u=t[2][0],l=t[2][1],d=t[2][2],f=t[2][3],p=t[3][0],g=t[3][1],m=t[3][2],v=t[3][3];e[0][0]=o*f*g-c*d*g+c*l*m-h*f*m-o*l*v+h*d*v,e[0][1]=a*d*g-r*f*g-a*l*m+n*f*m+r*l*v-n*d*v,e[0][2]=r*c*g-a*o*g+a*h*m-n*c*m-r*h*v+n*o*v,e[0][3]=a*o*l-r*c*l-a*h*d+n*c*d+r*h*f-n*o*f,e[1][0]=c*d*p-o*f*p-c*u*m+s*f*m+o*u*v-s*d*v,e[1][1]=r*f*p-a*d*p+a*u*m-i*f*m-r*u*v+i*d*v,e[1][2]=a*o*p-r*c*p-a*s*m+i*c*m+r*s*v-i*o*v,e[1][3]=r*c*u-a*o*u+a*s*d-i*c*d-r*s*f+i*o*f,e[2][0]=h*f*p-c*l*p+c*u*g-s*f*g-h*u*v+s*l*v,e[2][1]=a*l*p-n*f*p-a*u*g+i*f*g+n*u*v-i*l*v,e[2][2]=n*c*p-a*h*p+a*s*g-i*c*g-n*s*v+i*h*v,e[2][3]=a*h*u-n*c*u-a*s*l+i*c*l+n*s*f-i*h*f,e[3][0]=o*l*p-h*d*p-o*u*g+s*d*g+h*u*m-s*l*m,e[3][1]=n*d*p-r*l*p+r*u*g-i*d*g-n*u*m+i*l*m,e[3][2]=r*h*p-n*o*p-r*s*g+i*o*g+n*s*m-i*h*m,e[3][4]=n*o*u-r*h*u+r*s*l-i*o*l-n*s*d+i*h*d;var y=1/(i*e[0][0]+s*e[0][1]+u*e[0][2]+p*e[0][3]);return 0==y?e=[new Float32Array([1,0,0,0]),new Float32Array([0,1,0,0]),new Float32Array([0,0,1,0]),new Float32Array([0,0,0,1])]:(e[0][0]*=y,e[0][1]*=y,e[0][2]*=y,e[0][3]*=y,e[1][0]*=y,e[1][1]*=y,e[1][2]*=y,e[1][3]*=y,e[2][0]*=y,e[2][1]*=y,e[2][2]*=y,e[2][3]*=y,e[3][0]*=y,e[3][1]*=y,e[3][2]*=y,e[3][4]*=y),e}(t)},scaleValue:function(t,e,i,n,r){return(t-(e=e==i?0:e))/(i-e)*(r-n)+n}}}};z.use(f);var p={name:"util.color",extend:null,component:function(){var a=z.include("util.base"),s=z.include("util.math");var h={regex:/(linear|radial)\((.*)\)(.*)/i,format:function(t,e){if("hex"!=e)return"rgb"==e?void 0===t.a?"rgb("+[t.r,t.g,t.b].join(",")+")":"rgba("+[t.r,t.g,t.b,t.a].join(",")+")":t;var i=t.r.toString(16);t.r<16&&(i="0"+i);var n=t.g.toString(16);t.g<16&&(n="0"+n);var r=t.b.toString(16);return t.b<16&&(r="0"+r),"#"+[i,n,r].join("").toUpperCase()},scale:function(){var n,r;function a(t,e){var i={r:parseInt(n.r+(r.r-n.r)*t,10),g:parseInt(n.g+(r.g-n.g)*t,10),b:parseInt(n.b+(r.b-n.b)*t,10)};return h.format(i,e)}return a.domain=function(t,e){return n=h.rgb(t),r=h.rgb(e),a},a.ticks=function(t){for(var e=1/t,i=0,n=[];i<=1;){var r=a(i,"hex");n.push(r),i=s.plus(i,e)}return n},a},map:function(t,e){var i=[];e=e||5;for(var n=h.scale(),r=0,a=t.length-1;r<a;r++)if(0==r)i=n.domain(t[r],t[r+1]).ticks(e);else{var s=n.domain(t[r],t[r+1]).ticks(e);s.shift(),i=i.concat(s)}return i},rgb:function(t){if("string"==typeof t){if(-1<t.indexOf("rgb(")){for(var e=0,i=(n=t.replace("rgb(","").replace(")","").split(",")).length;e<i;e++)n[e]=parseInt(a.trim(n[e]),10);return{r:n[0],g:n[1],b:n[2],a:1}}if(-1<t.indexOf("rgba(")){for(e=0,i=(n=t.replace("rgba(","").replace(")","").split(",")).length;e<i;e++)n[e]=i-1==e?parseFloat(a.trim(n[e])):parseInt(a.trim(n[e]),10);return{r:n[0],g:n[1],b:n[2],a:n[3]}}if(0==t.indexOf("#")){var n=[];if(3==(t=t.replace("#","")).length)for(e=0,i=t.length;e<i;e++){var r=t.substr(e,1);n.push(parseInt(r+r,16))}else for(e=0,i=t.length;e<i;e+=2)n.push(parseInt(t.substr(e,2),16));return{r:n[0],g:n[1],b:n[2],a:1}}}return t},HSVtoRGB:function(t,e,i){360==t&&(t=0);var n=e*i,r=n*(1-Math.abs(t/60%2-1)),a=i-n,s=[];return 0<=t&&t<60?s=[n,r,0]:60<=t&&t<120?s=[r,n,0]:120<=t&&t<180?s=[0,n,r]:180<=t&&t<240?s=[0,r,n]:240<=t&&t<300?s=[r,0,n]:300<=t&&t<360&&(s=[n,0,r]),{r:Math.ceil(255*(s[0]+a)),g:Math.ceil(255*(s[1]+a)),b:Math.ceil(255*(s[2]+a))}},RGBtoHSV:function(t,e,i){var n=t/255,r=e/255,a=i/255,s=Math.max(n,r,a),h=s-Math.min(n,r,a),o=0;0==h?o=0:s==n?o=(r-a)/h%6*60:s==r?o=60*((a-n)/h+2):s==a&&(o=60*((n-r)/h+4)),o<0&&(o=360+o);return{h:o,s:0==s?0:h/s,v:s}},trim:function(t){return(t||"").replace(/^\s+|\s+$/g,"")},lighten:function(t,e){t=t.replace(/[^0-9a-f]/gi,""),e=e||0;var i,n,r=[];for(n=0;n<6;n+=2)i=parseInt(t.substr(n,2),16),i=Math.round(Math.min(Math.max(0,i+i*e),255)).toString(16),r.push(("00"+i).substr(i.length));return"#"+r.join("")},darken:function(t,e){return this.lighten(t,-e)},parse:function(t){return this.parseGradient(t)},parseGradient:function(t){var e=t.match(this.regex);if(!e)return t;var i=this.trim(e[1]);return{type:i+"Gradient",attr:this.parseAttr(i,this.trim(e[2])),children:this.parseStop(this.trim(e[3]))}},parseStop:function(t){for(var e=t.split(","),i=[],n=0,r=e.length;n<r;n++){var a=(t=e[n]).split(" ");0!=a.length&&(1==a.length?i.push({type:"stop",attr:{"stop-color":a[0]}}):2==a.length?i.push({type:"stop",attr:{offset:a[0],"stop-color":a[1]}}):3==a.length&&i.push({type:"stop",attr:{offset:a[0],"stop-color":a[1],"stop-opacity":a[2]}}))}var s=-1,h=-1;for(n=0,r=i.length;n<r;n++){t=i[n];if(0==n?t.offset||(t.offset=0):n==r-1&&(t.offset||(t.offset=1)),-1==s&&void 0===t.offset)s=n;else if(-1==h&&void 0===t.offset){for(var o=(h=n)-s,c=-1<i[h].offset.indexOf("%")?parseFloat(i[h].offset)/100:i[h].offset,u=-1<i[s].offset.indexOf("%")?parseFloat(i[s].offset)/100:i[s].offset,l=(c-u)/o,d=u+l,f=s+1;f<h;f++)i[f].offset=d,d+=l;s=h,h=-1}}return i},parseAttr:function(t,e){if("linear"!=t){for(n=0,r=(i=e.split(",")).length;n<r;n++)-1==i[n].indexOf("%")&&(i[n]=parseFloat(i[n]));return{cx:i[0],cy:i[1],r:i[2],fx:i[3],fy:i[4]}}switch(e){case"":case"left":return{x1:0,y1:0,x2:1,y2:0,direction:e||"left"};case"right":return{x1:1,y1:0,x2:0,y2:0,direction:e};case"top":return{x1:0,y1:0,x2:0,y2:1,direction:e};case"bottom":return{x1:0,y1:1,x2:0,y2:0,direction:e};case"top left":return{x1:0,y1:0,x2:1,y2:1,direction:e};case"top right":return{x1:1,y1:0,x2:0,y2:1,direction:e};case"bottom left":return{x1:0,y1:1,x2:1,y2:0,direction:e};case"bottom right":return{x1:1,y1:1,x2:0,y2:0,direction:e};default:for(var i,n=0,r=(i=e.split(",")).length;n<r;n++)-1==i[n].indexOf("%")&&(i[n]=parseFloat(i[n]));return{x1:i[0],y1:i[1],x2:i[2],y2:i[3]}}},colorHash:function(t,e){var i=0;return t&&(i=function(t){var e=0,i=1,n=0;if(t){for(var r=0;r<t.length&&!(6<r);r++)e+=i*(t.charCodeAt(r)%10),n+=9*i,i*=.7;0<n&&(e/=n)}return e}(t=(t=t.replace(/.*`/,"")).replace(/\(.*/,""))),"function"==typeof e?e(i):{r:200+Math.round(55*i),g:0+Math.round(230*(1-i)),b:0+Math.round(55*(1-i))}}};return h.map.parula=function(t){return h.map(["#352a87","#0f5cdd","#00b5a6","#ffc337","#fdff00"],t)},h.map.jet=function(t){return h.map(["#00008f","#0020ff","#00ffff","#51ff77","#fdff00","#ff0000","#800000"],t)},h.map.hsv=function(t){return h.map(["#ff0000","#ffff00","#00ff00","#00ffff","#0000ff","#ff00ff","#ff0000"],t)},h.map.hot=function(t){return h.map(["#0b0000","#ff0000","#ffff00","#ffffff"],t)},h.map.pink=function(t){return h.map(["#1e0000","#bd7b7b","#e7e5b2","#ffffff"],t)},h.map.bone=function(t){return h.map(["#000000","#4a4a68","#a6c6c6","#ffffff"],t)},h.map.copper=function(t){return h.map(["#000000","#3d2618","#9d623e","#ffa167","#ffc77f"],t)},h}},g={name:"collection",extend:null,component:function(){function t(t,e,i,n){this.type=t,this.selector=e,this.options=i,this.destroy=function(){for(var t=0;t<n.length;t++)n[t].destroy()};for(var r=0;r<n.length;r++)this.push(n[r])}return t.prototype=Object.create(Array.prototype),t}},m={name:"manager",extend:null,component:function(){var r=z.include("util.base"),a=new function(){var h=[],i=[];this.add=function(t){h.push(t)},this.emit=function(t,e,i){for(var n=[],r=0;r<h.length;r++){t!=(a=h[r]).selector&&t!=a.type||n.push(a)}for(r=0;r<n.length;r++)for(var a=n[r],s=0;s<a.length;s++)a[s].emit(e,i)},this.get=function(t){if(r.typeCheck("integer",t))return h[t];if(r.typeCheck("string",t)){for(var e=0;e<h.length;e++){if(t==(n=h[e]).selector)return 1==n.length?n[0]:n}var i=[];for(e=0;e<h.length;e++){var n;t==(n=h[e]).type&&i.push(n)}return i}},this.getAll=function(){return h},this.remove=function(t){if(r.typeCheck("integer",t))return h.splice(t,1)[0]},this.shift=function(){return h.shift()},this.pop=function(){return h.pop()},this.size=function(){return h.length},this.addClass=function(t){i.push(t)},this.getClass=function(t){if(r.typeCheck("integer",t))return i[t];if(r.typeCheck("string",t))for(var e=0;e<i.length;e++)if(t==i[e].type)return i[e];return null},this.getClassAll=function(){return i},this.create=function(t,e,i){var n=a.getClass(t);if(r.typeCheck("null",n))throw new Error("JUI_CRITICAL_ERR: '"+t+"' does not exist");return n.class(e,i)}};return a}};z.use(t,m,g);var v={name:"core",extend:null,component:function(){function i(){this.emit=function(t,e){if(h.typeCheck("string",t)){for(var i,n=0;n<this.event.length;n++){var r=this.event[n];if(r.type==t.toLowerCase()){var a=h.typeCheck("array",e)?e:[e];i=r.callback.apply(this,a)}}return i}},this.on=function(t,e){h.typeCheck("string",t)&&h.typeCheck("function",e)&&this.event.push({type:t.toLowerCase(),callback:e,unique:!1})},this.off=function(t){for(var e=[],i=0;i<this.event.length;i++){var n=this.event[i];(h.typeCheck("function",t)&&n.callback!=t||h.typeCheck("string",t)&&n.type!=t.toLowerCase())&&e.push(n)}this.event=e},this.setOption=function(t,e){if(h.typeCheck("object",t))for(var i in t)this.options[i]=t[i];else this.options[t]=e},this.destroy=function(){if(this.__proto__)for(var t in this.__proto__)delete this.__proto__[t]}}var h=z.include("util.base"),o=z.include("util.dom"),c=z.include("manager"),u=z.include("collection");return i.build=function(s){return function(t,e){var i=[],n=[];h.typeCheck("string",t)?n=o.find(t):h.typeCheck("object",t)?n.push(t):n.push(document.createElement("div"));for(var r=0,a=n.length;r<a;r++)i[r]=z.createUIObject(s,t,r,n[r],e);return c.add(new u(s.type,t,e,i)),0==i.length?null:1==i.length?i[0]:i}},i.init=function(t){var e=null;return"object"===(void 0===t?"undefined":l(t))&&(e=i.build(t),c.addClass({type:t.type,class:e})),e},i.setup=function(){return{event:{}}},i}},y={name:"util.time",extend:null,component:function(){var n=z.include("util.base"),r={MILLISECOND:1e3,MINUTE:6e4,HOUR:36e5,DAY:864e5,years:"years",months:"months",days:"days",hours:"hours",minutes:"minutes",seconds:"seconds",milliseconds:"milliseconds",weeks:"weeks",diff:function(t,e,i){var n=e-i;return"seconds"==t?Math.abs(Math.floor(n/r.MILLISECOND)):"minutes"==t?Math.abs(Math.floor(n/r.MINUTE)):"hours"==t?Math.abs(Math.floor(n/r.HOUR)):"days"==t?Math.abs(Math.floor(n/r.DAY)):n},add:function(t){if(arguments.length<=2)return t;if(2<arguments.length){for(var e=new Date(+t),i=1;i<arguments.length;i+=2){var n="string"==typeof arguments[i]?this[arguments[i]]:arguments[i],r=arguments[i+1];this.years==n?e.setFullYear(e.getFullYear()+r):this.months==n?e.setMonth(e.getMonth()+r):this.days==n?e.setDate(e.getDate()+r):this.hours==n?e.setHours(e.getHours()+r):this.minutes==n?e.setMinutes(e.getMinutes()+r):this.seconds==n?e.setSeconds(e.getSeconds()+r):this.milliseconds==n?e.setMilliseconds(e.getMilliseconds()+r):this.weeks==n&&e.setDate(e.getDate()+7*r)}return e}},format:function(t,e,i){return n.dateFormat(t,e,i)}};return r}};z.use(f);var x,w,b={name:"util.transform",extend:null,component:function(){var h=z.include("util.math");return function(s){function n(t){for(var e=0,i=s.length;e<i;e++)s[e]=h.matrix(t,s[e]);return s}this.matrix=function(){var t=arguments,e=t[0];return"move"==e?[new Float32Array([1,0,t[1]]),new Float32Array([0,1,t[2]]),new Float32Array([0,0,1])]:"scale"==e?[new Float32Array([t[1],0,0]),new Float32Array([0,t[2],0]),new Float32Array([0,0,1])]:"rotate"==e?[new Float32Array([Math.cos(h.radian(t[1])),-Math.sin(h.radian(t[1])),0]),new Float32Array([Math.sin(h.radian(t[1])),Math.cos(h.radian(t[1])),0]),new Float32Array([0,0,1])]:"move3d"==e?[new Float32Array([1,0,0,t[1]]),new Float32Array([0,1,0,t[2]]),new Float32Array([0,0,1,t[3]]),new Float32Array([0,0,0,1])]:"scale3d"==e?[new Float32Array([t[1],0,0,0]),new Float32Array([0,t[2],0,0]),new Float32Array([0,0,t[3],0]),new Float32Array([0,0,0,1])]:"rotate3dz"==e?[new Float32Array([Math.cos(h.radian(t[1])),-Math.sin(h.radian(t[1])),0,0]),new Float32Array([Math.sin(h.radian(t[1])),Math.cos(h.radian(t[1])),0,0]),new Float32Array([0,0,1,0]),new Float32Array([0,0,0,1])]:"rotate3dx"==e?[new Float32Array([1,0,0,0]),new Float32Array([0,Math.cos(h.radian(t[1])),-Math.sin(h.radian(t[1])),0]),new Float32Array([0,Math.sin(h.radian(t[1])),Math.cos(h.radian(t[1])),0]),new Float32Array([0,0,0,1])]:"rotate3dy"==e?[new Float32Array([Math.cos(h.radian(t[1])),0,Math.sin(h.radian(t[1])),0]),new Float32Array([0,1,0,0]),new Float32Array([-Math.sin(h.radian(t[1])),0,Math.cos(h.radian(t[1])),0]),new Float32Array([0,0,0,1])]:void 0},this.move=function(t,e){return n(this.matrix("move",t,e))},this.move3d=function(t,e,i){return n(this.matrix("move3d",t,e,i))},this.scale=function(t,e){return n(this.matrix("scale",t,e))},this.scale3d=function(t,e,i){return n(this.matrix("scale3d",t,e,i))},this.rotate=function(t){return n(this.matrix("rotate",t))},this.rotate3dz=function(t){return n(this.matrix("rotate3dz",t))},this.rotate3dx=function(t){return n(this.matrix("rotate3dx",t))},this.rotate3dy=function(t){return n(this.matrix("rotate3dy",t))},this.custom=function(t){return n(t)},this.merge=function(){for(var t=arguments,e=this.matrix.apply(this,t[0]),i=1;i<t.length;i++)e=h.matrix(e,this.matrix.apply(this,t[i]));return n(e)},this.merge2=function(t){for(var e=0,i=s.length;e<i;e++){for(var n=t.apply(null,s[e]),r=this.matrix.apply(this,n[0]),a=1;a<n.length;a++)r=h.matrix(r,this.matrix.apply(this,n[a]));s[e]=h.matrix(r,s[e])}}}}},k={name:"util.canvas.base",extend:null,component:function(){return function(u){this.clearContext=function(){u.clearRect(0,0,u.canvas.width,u.canvas.height)},this.drawLine=function(t,e,i,n,r){var a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1;r=r||"#434d6b",u.beginPath(),u.moveTo(t,e),u.lineTo(i,n),u.lineWidth=a,u.strokeStyle=r,u.stroke()},this.drawCurve=function(t,e,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:.5,r=4<arguments.length&&void 0!==arguments[4]&&arguments[4],a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:16;u.beginPath();var s=t.reduce(function(t,e){return t.push(e[0],e[1]),t},[]),h=getCurvePoints(s,e,i,n,r,a);u.moveTo(h[0],h[1]);for(var o=2;o<h.length-1;o+=2)u.lineTo(h[o],h[o+1])},this.drawDashedLine=function(t,e,i,n,r){var a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:[3,3],s=6<arguments.length&&void 0!==arguments[6]?arguments[6]:1;r=r||"#434d6b",u.beginPath(),u.moveTo(t,e),u.lineTo(i,n),u.lineWidth=s,u.strokeStyle=r;var h=u.getLineDash();u.setLineDash(a),u.stroke(),u.setLineDash(h)},this.drawLines=function(t){t=t||"#434d6b",u.beginPath();for(var e=arguments.length,i=Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];u.moveTo(i[0][0],i[0][1]),i.slice(1).map(function(t){return u.lineTo(t[0],t[1])}),u.lineWidth=1,u.strokeStyle=t,u.stroke()},this.drawRoundRect=function(t,e,i,n,r){u.beginPath(),u.moveTo(t,e+r),u.lineTo(t,e+n-r),u.arcTo(t,e+n,t+r,e+n,r),u.lineTo(t+i-r,e+n),u.arcTo(t+i,e+n,t+i,e+n-r,r),u.lineTo(t+i,e+r),u.arcTo(t+i,e,t+i-r,e,r),u.lineTo(t+r,e),u.arcTo(t,e,t,e+r,r),u.closePath()},this.drawFreeRect=function(t,e,i,n,r,a,s,h,o){var c=9<arguments.length&&void 0!==arguments[9]?arguments[9]:null;o=o||"#ffffff",u.beginPath(),u.moveTo(t,e),u.lineTo(i,n),u.lineTo(r,a),u.lineTo(s,h),u.closePath(),u.fillStyle=o,null!=c&&(u.lineWidth=2,u.strokeStyle=c,u.stroke()),u.fill()},this.drawFreeRectStroke=function(t,e,i,n,r,a,s,h,o){o=o||"#ffffff",u.beginPath(),u.moveTo(t,e),u.lineTo(i,n),u.lineTo(r,a),u.lineTo(s,h),u.lineWidth=1,u.strokeStyle=o,u.stroke()},this.drawTriangle=function(t,e,i,n){n=n||"#ffffff",u.beginPath(),u.moveTo(t,e-i),u.lineTo(t-i,e+i),u.lineTo(t+i,e+i),u.closePath(),u.fillStyle=n,u.fill()},this.drawSquare=function(t,e,i,n){n=n||"#ffffff",u.beginPath(),u.moveTo(t-i,e-i),u.lineTo(t-i,e+i),u.lineTo(t+i,e+i),u.lineTo(t+i,e-i),u.closePath(),u.fillStyle=n,u.fill()},this.drawPage=function(t,e,i,n){drawFreeRect(u,t+e,i,t+e-20,i+14,t+e-20,i+52,t+e,i+38,n,4<arguments.length&&void 0!==arguments[4]&&arguments[4]?"rgba(255,255,255,0.2)":null)},this.drawCircle=function(t,e,i,n){n=n||"white",i=i||1,u.beginPath(),u.arc(t,e,i,0,2*Math.PI),u.fillStyle=n,u.fill()},this.drawBullet=function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:74,n=u.createLinearGradient(t,e,t+i,e);n.addColorStop(0,"#1074fc"),n.addColorStop(1,"rgba(37, 172, 254, 0)"),u.beginPath(),u.arc(t,e,2,Math.PI/2,Math.PI/2*3),u.lineTo(t+i,e-2),u.lineTo(t+i,e+2),u.closePath(),u.fillStyle=n,u.fill(),u.fillStyle=n},this.getCurvePoints=function(t,e,i){var n,r,a,s,h,o,c,u,l,d,f,p,g,m=3<arguments.length&&void 0!==arguments[3]?arguments[3]:.5,v=4<arguments.length&&void 0!==arguments[4]&&arguments[4],y=5<arguments.length&&void 0!==arguments[5]?arguments[5]:16,x=[],w=[];for(x=t.slice(0),v?(x.unshift(t[t.length-1]),x.unshift(t[t.length-2]),x.unshift(t[t.length-1]),x.unshift(t[t.length-2]),x.push(t[0]),x.push(t[1])):(x.unshift(t[1]),x.unshift(t[0]),x.push(t[t.length-2]),x.push(t[t.length-1])),g=2;g<x.length-4;g+=2)for(p=0;p<=y;p++)a=(x[g+2]-x[g-2])*m,s=(x[g+4]-x[g])*m,h=(x[g+3]-x[g-1])*m,o=(x[g+5]-x[g+1])*m,f=p/y,c=2*Math.pow(f,3)-3*Math.pow(f,2)+1,u=-2*Math.pow(f,3)+3*Math.pow(f,2),l=Math.pow(f,3)-2*Math.pow(f,2)+f,d=Math.pow(f,3)-Math.pow(f,2),n=c*x[g]+u*x[g+2]+l*a+d*s,r=c*x[g+1]+u*x[g+3]+l*h+d*o,w.push(n),i<r?w.push(i):r<e?w.push(e):w.push(r);return w}}}},C=(x=document.createElement("canvas").getContext("2d"),w=x&&(x.backingStorePixelRatio||x.webkitBackingStorePixelRatio||x.mozBackingStorePixelRatio||x.msBackingStorePixelRatio||x.oBackingStorePixelRatio||x.backingStorePixelRatio)||1,(window.devicePixelRatio||1)/w);function M(e){var t,i,n;1!=C&&(function(t,e){for(var i in t)t.hasOwnProperty(i)&&e(t[i],i)}({fillRect:"all",clearRect:"all",strokeRect:"all",moveTo:"all",lineTo:"all",arc:[0,1,2],arcTo:"all",bezierCurveTo:"all",isPointinPath:"all",isPointinStroke:"all",quadraticCurveTo:"all",rect:"all",translate:"all",createRadialGradient:"all",createLinearGradient:"all"},function(n,t){var r;e[t]=(r=e[t],function(){var t=void 0,e=void 0,i=Array.prototype.slice.call(arguments);if("all"===n)i=i.map(function(t){return t*C});else if(Array.isArray(n))for(t=0,e=n.length;t<e;t++)i[n[t]]*=C;return r.apply(this,i)})}),e.stroke=(t=e.stroke,function(){this.lineWidth*=C,t.apply(this,arguments),this.lineWidth/=C}),e.fillText=(i=e.fillText,function(){var t=Array.prototype.slice.call(arguments);t[1]*=C,t[2]*=C,this.font=this.font.replace(/(\d+)(px|em|rem|pt)/g,function(t,e,i){return e*C+i}),i.apply(this,t),this.font=this.font.replace(/(\d+)(px|em|rem|pt)/g,function(t,e,i){return e/C+i})}),e.strokeText=(n=e.strokeText,function(){var t=Array.prototype.slice.call(arguments);t[1]*=C,t[2]*=C,this.font=this.font.replace(/(\d+)(px|em|rem|pt)/g,function(t,e,i){return e*C+i}),n.apply(this,t),this.font=this.font.replace(/(\d+)(px|em|rem|pt)/g,function(t,e,i){return e/C+i})}))}function T(t){var i;t.getContext=(i=t.getContext,function(t){var e=i.call(this,t);return"2d"===t&&1<C&&(this.style.height=this.height+"px",this.style.width=this.width+"px",this.width*=C,this.height*=C),e})}var A={name:"util.canvas.hidpi",extend:null,component:function(){return{polyfills:function(){M(CanvasRenderingContext2D.prototype),T(HTMLCanvasElement.prototype)},apply:function(t){M(t)},pixelRatio:C}}},F={name:"util.svg.element",extend:null,component:function(){return function e(){var a=[];this.create=function(t,e){this.element=document.createElementNS("http://www.w3.org/2000/svg",t),this.children=[],this.parent=null,this.styles={},this.attributes={},this.order=0,this.attr(e)},this.each=function(t){if("function"==typeof t){for(var e=0,i=this.children.length;e<i;e++){var n=this.children[e];t.apply(n,[e,n])}return this.children}},this.get=function(t){return this.children[t]?this.children[t]:null},this.index=function(t){for(var e=0;e<this.children.length;e++)if(t==this.children[e])return e;return-1},this.append=function(t){return t instanceof e&&(t.parent&&t.remove(),this.children.push(t),t.parent=this),this},this.prepend=function(t){return this.insert(0,t)},this.insert=function(t,e){return e.parent&&e.remove(),this.children.splice(t,0,e),e.parent=this},this.remove=function(){for(var t=[],e=this.parent.children,i=0;i<e.length&&e[i]!=this;i++)t.push(e[i]);return this.parent.children=t,this},this.attr=function(t){if(void 0!==t&&t){if("string"==typeof t)return this.attributes[t]||this.element.getAttribute(t);for(var e in t)this.attributes[e]=t[e],-1!=e.indexOf("xlink:")?this.element.setAttributeNS("http://www.w3.org/1999/xlink",e,t[e]):this.element.setAttribute(e,t[e]);return this}},this.css=function(t){var e=[];for(var i in t)this.styles[i]=t[i];for(var i in t)e.push(i+":"+t[i]);return this.attr({style:e.join(";")}),this},this.html=function(t){return this.element.innerHTML=t,this},this.text=function(t){for(var e=this.element.childNodes,i=0;i<e.length;i++)this.element.removeChild(e[i]);return this.element.appendChild(document.createTextNode(t)),this},this.on=function(t,e){function i(t){"function"==typeof e&&e.call(this,t)}return this.element.addEventListener(t,i,!1),a.push({type:t,callback:i}),this},this.off=function(t){if(t){var e=[];for(i=0,n=a.length;i<n;i++){(r=a[i]).type!=t?e.push(r):this.element.removeEventListener(r.type,r.callback,!1)}a=e}else for(var i=0,n=a.length;i<n;i++){var r=a.shift();this.element.removeEventListener(r.type,r.callback,!1)}return this},this.hover=function(e,i){function t(t){"function"==typeof e&&e.call(this,t)}function n(t){"function"==typeof i&&i.call(this,t)}return this.element.addEventListener("mouseover",t,!1),this.element.addEventListener("mouseout",n,!1),a.push({type:"mouseover",callback:t}),a.push({type:"mouseout",callback:n}),this},this.size=function(){var t={width:0,height:0},e=this.element.getBoundingClientRect();if(!e||0==e.width&&0==e.height){for(var i=["height","paddingTop","paddingBottom","borderTopWidth","borderBottomWidth"],n=["width","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],r=window.getComputedStyle(this.element),a=0;a<i.length;a++)t.height+=parseFloat(r[i[a]]);for(a=0;a<n.length;a++)t.width+=parseFloat(r[n[a]]);t.width=t.width||this.element.getAttribute("width"),t.height=t.height||this.element.getAttribute("height")}else t.width=e.width,t.height=e.height;return isNaN(t.width)&&(t.width=0),isNaN(t.height)&&(t.height=0),t},this.is=function(t){return this instanceof jui.include(t)}}}},R={name:"util.svg.element.transform",extend:"util.svg.element",component:function(){var i=z.include("util.base");return function(){var r={translate:null,scale:null,rotate:null,skew:null,matrix:null};function a(t){var e=[];for(var i in r)r[i]&&e.push(r[i]);t.attr({transform:e.join(" ")})}function t(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e.join(",")}this.translate=function(){return r.translate="translate("+t(arguments)+")",a(this),this},this.rotate=function(t,e,i){if(1==arguments.length)var n=t;else if(3==arguments.length)n=t+" "+e+","+i;return r.rotate="rotate("+n+")",a(this),this},this.scale=function(){return r.scale="scale("+t(arguments)+")",a(this),this},this.skew=function(){return r.skew="skew("+t(arguments)+")",a(this),this},this.matrix=function(){return r.matrix="matrix("+t(arguments)+")",a(this),this},this.data=function(t){var e=this.attr("transform");return i.typeCheck("string",e)?e.match({translate:/[^translate()]+/g,rotate:/[^rotate()]+/g,scale:/[^scale()]+/g,skew:/[^skew()]+/g,matrix:/[^matrix()]+/g}[t])[0]:null}}}},L={name:"util.svg.element.path",extend:"util.svg.element.transform",component:function(){var a=z.include("util.base");return function(){var o=[];this.moveTo=function(t,e,i){return o.push((i||"m")+t+","+e),this},this.MoveTo=function(t,e){return this.moveTo(t,e,"M")},this.lineTo=function(t,e,i){return o.push((i||"l")+t+","+e),this},this.LineTo=function(t,e){return this.lineTo(t,e,"L")},this.hLineTo=function(t,e){return o.push((e||"h")+t),this},this.HLineTo=function(t){return this.hLineTo(t,"H")},this.vLineTo=function(t,e){return o.push((e||"v")+t),this},this.VLineTo=function(t){return this.vLineTo(t,"V")},this.curveTo=function(t,e,i,n,r,a,s){return o.push((s||"c")+t+","+e+" "+i+","+n+" "+r+","+a),this},this.CurveTo=function(t,e,i,n,r,a){return this.curveTo(t,e,i,n,r,a,"C")},this.sCurveTo=function(t,e,i,n,r){return o.push((r||"s")+t+","+e+" "+i+","+n),this},this.SCurveTo=function(t,e,i,n){return this.sCurveTo(t,e,i,n,"S")},this.qCurveTo=function(t,e,i,n,r){return o.push((r||"q")+t+","+e+" "+i+","+n),this},this.QCurveTo=function(t,e,i,n){return this.qCurveTo(t,e,i,n,"Q")},this.tCurveTo=function(t,e,i,n,r){return o.push((r||"t")+t+","+e+" "+i+","+n),this},this.TCurveTo=function(t,e,i,n){return this.tCurveTo(t,e,i,n,"T")},this.arc=function(t,e,i,n,r,a,s,h){return n=n?1:0,r=r?1:0,o.push((h||"a")+t+","+e+" "+i+" "+n+","+r+" "+a+","+s),this},this.Arc=function(t,e,i,n,r,a,s){return this.arc(t,e,i,n,r,a,s,"A")},this.closePath=function(t){return o.push(t||"z"),this},this.ClosePath=function(){return this.closePath("Z")},this.join=function(){0<o.length&&(this.attr({d:o.join(" ")}),o=[])},this.length=function(){var t=a.createId(),e=o.join(" "),i=document.createElement("svg"),n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttributeNS(null,"id",t),n.setAttributeNS(null,"d",e),i.appendChild(n),document.body.appendChild(i);var r=document.getElementById(t).getTotalLength();return document.body.removeChild(i),r}}}},B={name:"util.svg.element.path.rect",extend:"util.svg.element.path",component:function(){return function(){this.round=function(t,e,i,n,r,a){i=i||0,n=n||0,r=r||0,a=a||0,this.MoveTo(0,i).Arc(i,i,0,0,1,i,0).HLineTo(t-n).Arc(n,n,0,0,1,t,n).VLineTo(e-r).Arc(r,r,0,0,1,t-r,e).HLineTo(a).Arc(a,a,0,0,1,0,e-a).ClosePath().join()}}}},S={name:"util.svg.element.path.symbol",extend:"util.svg.element.path",component:function(){return function(){var n="";this.template=function(t,e){var i=t,n=half_r=t/2,r=e/2,a="a"+half_r+","+half_r+" 0 1,1 "+i+",0",s="a"+half_r+","+half_r+" 0 1,1 "+-i+",0",h={triangle:["m0,"+-r,"l"+n+","+e,"l"+-t+",0","l"+n+","+-e].join(" "),rect:["m"+-n+","+-r,"l"+t+",0","l0,"+e,"l"+-t+",0","l0,"+-e].join(" "),cross:["m"+-n+","+-r,"l"+t+","+e,"m0,"+-e,"l"+-t+","+e].join(" "),circle:["m"+-i+",0",a,s].join(" ")};return h.rectangle=h.rect,h},this.join=function(){0<n.length&&(this.attr({d:n}),n="")},this.add=function(t,e,i){n+=" M"+t+","+e+i},this.triangle=function(t,e,i,n){return this.MoveTo(t,e).moveTo(0,-n/2).lineTo(i/2,n).lineTo(-i,0).lineTo(i/2,-n)},this.rect=this.rectangle=function(t,e,i,n){return this.MoveTo(t,e).moveTo(-i/2,-n/2).lineTo(i,0).lineTo(0,n).lineTo(-i,0).lineTo(0,-n)},this.cross=function(t,e,i,n){return this.MoveTo(t,e).moveTo(-i/2,-n/2).lineTo(i,n).moveTo(0,-n).lineTo(-i,n)},this.circle=function(t,e,i){return this.MoveTo(t,e).moveTo(-i,0).arc(i/2,i/2,0,1,1,i,0).arc(i/2,i/2,0,1,1,-i,0)}}}},j={name:"util.svg.element.poly",extend:"util.svg.element.transform",component:function(){return function(){var i=[];this.point=function(t,e){return i.push(t+","+e),this},this.join=function(){if(0<i.length){var t=i[0];i.push(t),this.attr({points:i.join(" ")}),i=[]}}}}};z.use(F,R,L,S,B,j);var D={name:"util.svg.base",extend:null,component:function(){function n(){this.create=function(t,e,i,n){return t.create(e,i),t},this.createChild=function(t,e,i,n){return this.create(t,e,i,n)},this.custom=function(t,e,i){return this.create(new r,t,e,i)},this.defs=function(t){return this.create(new r,"defs",null,t)},this.symbol=function(t,e){return this.create(new r,"symbol",t,e)},this.g=this.group=function(t,e){return this.create(new a,"g",t,e)},this.marker=function(t,e){return this.create(new r,"marker",t,e)},this.a=function(t,e){return this.create(new a,"a",t,e)},this.switch=function(t,e){return this.create(new r,"switch",t,e)},this.use=function(t){return this.create(new r,"use",t)},this.rect=function(t,e){return this.create(new a,"rect",t,e)},this.line=function(t,e){return this.create(new a,"line",t,e)},this.circle=function(t,e){return this.create(new a,"circle",t,e)},this.text=function(t,e){return 2==arguments.length?i.typeCheck("function",e)?this.create(new a,"text",t,e):this.create(new a,"text",t).text(e):this.create(new a,"text",t)},this.textPath=function(t,e){return i.typeCheck("string",e)?this.create(new r,"textPath",t).text(e):this.create(new r,"textPath",t)},this.tref=function(t,e){return i.typeCheck("string",e)?this.create(new r,"tref",t).text(e):this.create(new r,"tref",t)},this.tspan=function(t,e){return i.typeCheck("string",e)?this.create(new r,"tspan",t).text(e):this.create(new r,"tspan",t)},this.ellipse=function(t,e){return this.create(new a,"ellipse",t,e)},this.image=function(t,e){return this.create(new a,"image",t,e)},this.path=function(t,e){return this.create(new s,"path",t,e)},this.pathSymbol=function(t,e){return this.create(new h,"path",t,e)},this.pathRect=function(t,e){return this.create(new o,"path",t,e)},this.polyline=function(t,e){return this.create(new c,"polyline",t,e)},this.polygon=function(t,e){return this.create(new c,"polygon",t,e)},this.pattern=function(t,e){return this.create(new r,"pattern",t,e)},this.mask=function(t,e){return this.create(new r,"mask",t,e)},this.clipPath=function(t,e){return this.create(new r,"clipPath",t,e)},this.linearGradient=function(t,e){return this.create(new r,"linearGradient",t,e)},this.radialGradient=function(t,e){return this.create(new r,"radialGradient",t,e)},this.filter=function(t,e){return this.create(new r,"filter",t,e)},this.foreignObject=function(t,e){return this.create(new a,"foreignObject",t,e)},this.stop=function(t){return this.createChild(new r,"stop",t)},this.animate=function(t){return this.createChild(new r,"animate",t)},this.animateColor=function(t){return this.createChild(new r,"animateColor",t)},this.animateMotion=function(t){return this.createChild(new r,"animateMotion",t)},this.animateTransform=function(t){return this.createChild(new r,"animateTransform",t)},this.mpath=function(t){return this.createChild(new r,"mpath",t)},this.set=function(t){return this.createChild(new r,"set",t)},this.feBlend=function(t){return this.createChild(new r,"feBlend",t)},this.feColorMatrix=function(t){return this.createChild(new r,"feColorMatrix",t)},this.feComponentTransfer=function(t){return this.createChild(new r,"feComponentTransfer",t)},this.feComposite=function(t){return this.createChild(new r,"feComposite",t)},this.feConvolveMatrix=function(t){return this.createChild(new r,"feConvolveMatrix",t)},this.feDiffuseLighting=function(t){return this.createChild(new r,"feDiffuseLighting",t)},this.feDisplacementMap=function(t){return this.createChild(new r,"feDisplacementMap",t)},this.feFlood=function(t){return this.createChild(new r,"feFlood",t)},this.feGaussianBlur=function(t){return this.createChild(new r,"feGaussianBlur",t)},this.feImage=function(t){return this.createChild(new r,"feImage",t)},this.feMerge=function(t,e){return this.createChild(new r,"feMerge",t,e)},this.feMergeNode=function(t){return this.createChild(new r,"feMergeNode",t)},this.feMorphology=function(t){return this.createChild(new r,"feMorphology",t)},this.feOffset=function(t){return this.createChild(new r,"feOffset",t)},this.feSpecularLighting=function(t){return this.createChild(new r,"feSpecularLighting",t)},this.feTile=function(t){return this.createChild(new r,"feTile",t)},this.feTurbulence=function(t){return this.createChild(new r,"feTurbulence",t)}}var i=z.include("util.base"),r=z.include("util.svg.element"),a=z.include("util.svg.element.transform"),s=z.include("util.svg.element.path"),h=z.include("util.svg.element.path.symbol"),o=z.include("util.svg.element.path.rect"),c=z.include("util.svg.element.poly"),u=null;return n.create=function(t,e,i){return null==u&&(u=new n),u.custom(t,e,i)},n}};z.use(f,p,D);var I={name:"util.svg.base3d",extend:"util.svg.base",component:function(){var f=z.include("util.base"),p=z.include("util.math"),g=z.include("util.color");return function(){this.rect3d=function(t,e,i,n,r){var a=this,s=p.radian(n),h=e,o=i,c=Math.cos(s)*r,u=Math.sin(s)*r,l=e+c,d=i+u;return a.group({},function(){a.path({fill:g.lighten(t,.15),stroke:g.lighten(t,.15)}).MoveTo(c,0).LineTo(l,0).LineTo(h,u).LineTo(0,u),a.path({fill:t,stroke:t}).MoveTo(0,u).LineTo(0,d).LineTo(h,d).LineTo(h,u),a.path({fill:g.darken(t,.2),stroke:g.darken(t,.2)}).MoveTo(h,d).LineTo(l,o).LineTo(l,0).LineTo(h,u)})},this.cylinder3d=function(t,e,i,n,r,a){var s=this,h=p.radian(n),o=e/2,c=o*(a=null==a?1:0==a?.01:a),u=Math.cos(h)*r/2,l=Math.sin(h)*r/2,d=f.createId("cylinder3d");return s.group({},function(){s.ellipse({fill:g.darken(t,.05),"fill-opacity":.85,stroke:g.darken(t,.05),rx:o,ry:l,cx:o,cy:i}).translate(u,l),s.path({fill:"url(#"+d+")","fill-opacity":.85,stroke:t}).MoveTo(o-c,l).LineTo(0,i).Arc(o,l,0,0,0,e,i).LineTo(o+c,l).Arc(o+c,l,0,0,1,o-c,l).translate(u,l),s.ellipse({fill:g.lighten(t,.2),"fill-opacity":.95,stroke:g.lighten(t,.2),rx:o*a,ry:l*a,cx:o,cy:l}).translate(u,l),s.linearGradient({id:d,x1:"100%",x2:"0%",y1:"0%",y2:"0%"},function(){s.stop({offset:"0%","stop-color":g.lighten(t,.15)}),s.stop({offset:"33.333333333333336%","stop-color":g.darken(t,.2)}),s.stop({offset:"66.66666666666667%","stop-color":g.darken(t,.2)}),s.stop({offset:"100%","stop-color":g.lighten(t,.15)})})})}}}};z.use(I);var P={name:"util.svg",extend:"util.svg.base3d",component:function(){function r(e,t){var i=this,s=null,r=null,n=null,a={},h=0,o=!1;function c(t){var e=t.children;!function(t){for(var e=0,i=t.length;e<i;e++)if(0<t[e].order)return!0;return!1}(e)||e.sort(function(t,e){return t.order-e.order});for(var i=0,n=e.length;i<n;i++){var r=e[i];r&&(0<r.children.length&&c(r),(r instanceof p||r instanceof g)&&r.join(),r.parent==t&&t.element.appendChild(r.element))}}function u(t){for(var e=t.children,i=0,n=e.length;i<n;i++){var r=e[i];r&&(r.off(),0<r.children.length&&u(r))}}this.create=function(t,e,i,n){return t.create(e,i),0==h?r.append(t):a[h].append(t),l.typeCheck("function",n)&&(a[++h]=t,n.call(t),h--),t},this.createChild=function(t,e,i,n){if(t.parent==r)throw new Error("JUI_CRITICAL_ERR: Parents are required elements of the '"+e+"'");return this.create(t,e,i,n)},this.size=function(){if(2!=arguments.length)return s.size();var t=arguments[0],e=arguments[1];s.attr({width:t,height:e})},this.clear=function(t){r.each(function(){this.element.parentNode&&r.element.removeChild(this.element)}),u(r),!0===t&&(n.each(function(){this.element.parentNode&&n.element.removeChild(this.element)}),u(n))},this.reset=function(t){this.clear(t),r.children=[],!0===t&&(n.children=[])},this.render=function(t){this.clear(),c(!1===o||!0===t?s:r),o=!0},this.download=function(t){l.typeCheck("string",t)&&(t=t.split(".")[0]);var e=document.createElement("a");e.download=t?t+".svg":"svg.svg",e.href=this.toDataURI(),document.body.appendChild(e),e.click(),e.parentNode.removeChild(e)},this.downloadImage=function(n,r){r=r||"image/png";var a=new Image,t=this.size(),e=this.toDataURI().replace('width="100%"','width="'+t.width+'"').replace('height="100%"','height="'+t.height+'"');a.onload=function(){var t=document.createElement("canvas");t.width=a.width,t.height=a.height,t.getContext("2d").drawImage(a,0,0);var e=t.toDataURL(r);l.typeCheck("string",n)&&(n=n.split(".")[0]);var i=document.createElement("a");i.download=n?n+".png":"svg.png",i.href=e,document.body.appendChild(i),i.click(),i.parentNode.removeChild(i)},a.src=e},this.exportCanvas=function(t){var e=new Image,i=this.size(),n=this.toDataURI().replace('width="100%"','width="'+i.width+'"').replace('height="100%"','height="'+i.height+'"');e.onload=function(){t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0)},e.src=n},this.toXML=function(){var t=e.innerHTML;return['<?xml version="1.0" encoding="utf-8"?>',(t=t.replace('xmlns="http://www.w3.org/2000/svg"',"")).replace("<svg ",'<svg xmlns="http://www.w3.org/2000/svg" ')].join("\n")},this.toDataURI=function(){var t=this.toXML();return(l.browser.mozilla||l.browser.msie)&&(t=encodeURIComponent(t)),l.browser.msie?"data:image/svg+xml,"+t:"data:image/svg+xml;utf8,"+t},this.autoRender=function(t,e){0<h||(e?r.append(t):n.append(t))},this.getTextSize=function(t,e){if(""==t)return{width:0,height:0};e=e||{};var i=document.body||s.element,n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttributeNS(null,"width",500),n.setAttributeNS(null,"height",100),n.setAttributeNS(null,"x",-2e4),n.setAttributeNS(null,"y",-2e4);var r=document.createElementNS("http://www.w3.org/2000/svg","text");r.setAttributeNS(null,"x",-200),r.setAttributeNS(null,"y",-200),r.appendChild(document.createTextNode(t)),e.fontSize&&r.setAttributeNS(null,"font-size",e.fontSize),e.fontFamily&&r.setAttributeNS(null,"font-family",e.fontFamily),e.bold&&r.setAttributeNS(null,"font-weight",e.bold),e.style&&r.setAttributeNS(null,"font-style",e.style),n.appendChild(r),i.appendChild(n);var a=r.getBoundingClientRect();return i.removeChild(n),{width:a.width,height:a.height}},i.root=s=new d,r=new f,n=new f,s.create("svg",t),r.create("g"),n.create("g"),r.translate(.5,.5),n.translate(.5,.5),e.appendChild(s.element),s.append(r),s.append(n)}var l=z.include("util.base"),d=z.include("util.svg.element"),f=z.include("util.svg.element.transform"),p=z.include("util.svg.element.path"),g=z.include("util.svg.element.poly");return r.createObject=function(t){var e=new d;if(e.create(t.type,t.attr),t.children instanceof Array)for(var i=0,n=t.children.length;i<n;i++)e.append(r.createObject(t.children[i]));return e},r}};z.use([f]);var E={name:"util.scale.linear",extend:null,component:function(){var y=z.include("util.math");return function e(){var g=[0,1],i=[0,1],n=!1,r=!1,t={},a=null,s=null,h=null,o=null,c=null,u=null,l=null,d=null,f=0,p=null,m=null;function v(t){if(o<t)return r?v(o):i[0]+Math.abs(t-g[0])*f;if(t<h)return r?v(h):i[0]-Math.abs(t-g[0])*f;var e=(t-g[0])/l;return p(e)}return v.cache=function(){return t},v.min=function(){return Math.min.apply(Math,g)},v.max=function(){return Math.max.apply(Math,g)},v.rangeMin=function(){return Math.min.apply(Math,i)},v.rangeMax=function(){return Math.max.apply(Math,i)},v.rate=function(t,e){return v(v.max()*(t/e))},v.clamp=function(t){r=t||!1},v.domain=function(t){if(!arguments.length)return g;for(var e=0;e<t.length;e++)g[e]=t[e];return h=v.min(),o=v.max(),l=g[1]-g[0],this},v.range=function(t){if(!arguments.length)return i;for(var e=0;e<t.length;e++)i[e]=t[e];return a=y.interpolateRound(i[0],i[1]),s=y.interpolateNumber(i[0],i[1]),c=v.rangeMin(),u=v.rangeMax(),d=Math.abs(u-c),f=d/l,p=n?a:s,this},v.rangeRound=function(t){return n=!0,v.range(t)},v.rangeBand=function(){return m},v.invert=function(t){return e().domain(i).range(g)(t)},v.ticks=function(t,e,i,n){n=n||!1;var r=v.max();if(0==g[0]&&0==g[1])return[];for(var a=y.nice(g[0],g[1],t||10,e||!1),s=[],h=n?a.max:a.min,o=n?a.min:a.max,c=a.spacing,u=y.fixed(c);n?o<=h:h<=o;)s.push(h),h=n?u.minus(h,c):u.plus(h,c);if(n){s[0]!=r&&s.unshift(r);for(var l=0,d=s.length;l<d;l++)s[l]=Math.abs(s[l]-r)}else s[s.length-1]!=o&&o<h&&s.push(o),g[0]>g[1]&&s.reverse();var f=v(s[0]),p=v(s[1]);return m=Math.abs(p-f),s},v}}},O={name:"util.scale.log",extend:null,component:function(){var l=z.include("util.base"),d=z.include("util.scale.linear");return function(t){var e=t||10,h=d(),n=[],r=null,a=null;function i(t){return t<0?-Math.log(Math.abs(t))/Math.log(e):0<t?Math.log(t)/Math.log(e):0}function o(t){return t<0?-Math.pow(e,Math.abs(t)):0<t?Math.pow(e,t):0}function s(t){return Math.pow(e,(t+"").length-1)<t}function c(t){return Math.pow(e,(t+"").length)}function u(t){var e=t;return r<t?e=r:t<a&&(e=a),h(i(e))}return l.extend(u,h),u.log=function(){for(var t=[],e=0;e<n.length;e++)t[e]=i(n[e]);return t},u.domain=function(t){if(!arguments.length)return n;for(var e=0;e<t.length;e++)n[e]=t[e];if(r=Math.max.apply(Math,n),a=Math.min.apply(Math,n),s(r)&&(n[1]=r=c(r)),s(Math.abs(a))){var i=c(Math.abs(a));n[0]=a=a<0?-i:i}return h.domain(u.log()),u},u.base=function(t){return h.domain(u.log()),u},u.invert=function(t){return o(h.invert(t))},u.ticks=function(t,e,i){var n=h.ticks(t,e,i||1e20,!0);n[n.length-1]<h.max()&&n.push(h.max());for(var r=[],a=0,s=n.length;a<s;a++)r[a]=o(n[a]);return r},u}}},Y={name:"util.scale.ordinal",extend:null,component:function(){return function(){var h=[],o=[],c=0,r={},u=!1;function l(t){var e=""+t;if(void 0!==r[e])return r[e];for(var i=-1,n=0;n<h.length;n++)if("string"==typeof t&&h[n]===t){i=n;break}return-1<i?(r[e]=o[i],o[i]):void 0!==o[t]?(r[e]=o[t],o[t]):null}return l.domain=function(t){if(void 0===t)return h;for(var e=0;e<t.length;e++)h[e]=t[e];return this},l.range=function(t){if(void 0===t)return o;for(var e=0;e<t.length;e++)o[e]=t[e];return this},l.rangePoints=function(t,e){e=e||0;for(var i=h.length,n=(t[1]-t[0]-e)/i,r=[],a=0;a<h.length;a++)r[a]=0==a?t[0]+e/2+n/2:r[a-1]+n;return o=r,c=n,u=!0,l},l.rangeBands=function(t,e,i){for(var n=h.length-1,r=(t[1]-t[0])/n,a=[],s=0;s<h.length;s++)a[s]=0==s?t[0]:r+a[s-1];return c=r,o=a,u=!1,l},l.rangeBand=function(){return c},l.invert=function(t){var e=Math.min(o[0],o[1]);if(u){var i=t;i<(e-=c/2)&&(i=e);var n=Math.abs(i-e)/c;return Math.floor(n)}n=Math.abs(t-e)/c;return Math.ceil(n)},l}}},W={name:"util.scale.time",extend:null,component:function(){var d=z.include("util.time"),n=z.include("util.scale.linear");return function(){var c,u=[],l=n(),i=l.domain;return l.domain=function(t){if(!arguments.length)return i.call(l);for(var e=0;e<t.length;e++)u[e]=+t[e];return i.call(l,u)},l.min=function(){return Math.min(u[0],u[u.length-1])},l.max=function(){return Math.max(u[0],u[u.length-1])},l.rate=function(t,e){return l(l.max()*(t/e))},l.ticks=function(t,e){for(var i=u[0],n=u[1],r=[];i<n;)r.push(new Date(+i)),i=d.add(i,t,e);r.push(new Date(+i));var a=l(r[1]),s=l(r[2]);return c=s-a,r},l.realTicks=function(t,e){var i=u[0],n=u[1],r=[],a=new Date(+i),s=null;for(t==d.years?s=new Date(a.getFullYear(),0,1):t==d.months?s=new Date(a.getFullYear(),a.getMonth(),1):t==d.days||t==d.weeks?s=new Date(a.getFullYear(),a.getMonth(),a.getDate()):t==d.hours?s=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),0,0,0):t==d.minutes?s=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),0,0):t==d.seconds?s=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),0):t==d.milliseconds&&(s=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds())),s=d.add(s,t,e);+s<+n;)r.push(new Date(+s)),s=d.add(s,t,e);var h=l(r[1]),o=l(r[2]);return c=o-h,r},l.rangeBand=function(){return c},l.invert=function(t){var e=n().domain(l.range()).range(l.domain());return new Date(e(t))},l}}};z.use([f,y]);var X={name:"util.scale",extend:null,component:function(){var y=z.include("util.math"),d=z.include("util.time"),x={circle:function(){var h=[],o=[],c=0;function u(t){}return u.domain=function(t){if(void 0===t)return h;for(var e=0;e<t.length;e++)h[e]=t[e];return this},u.range=function(t){if(void 0===t)return o;for(var e=0;e<t.length;e++)o[e]=t[e];return this},u.rangePoints=function(t,e){e=e||0;for(var i=h.length,n=(t[1]-t[0]-e)/i,r=[],a=0;a<h.length;a++)r[a]=0==a?t[0]+e/2+n/2:r[a-1]+n;return o=r,c=n,u},u.rangeBands=function(t,e,i){for(var n=h.length-1,r=(t[1]-t[0])/n,a=[],s=0;s<h.length;s++)a[s]=0==s?t[0]:r+a[s-1];return c=r,o=a,u},u.rangeBand=function(){return c},u},ordinal:function(){var h=[],o=[],c=0,r={};function u(t){var e=""+t;if(void 0!==r[e])return r[e];for(var i=-1,n=0;n<h.length;n++)if("string"==typeof t&&h[n]===t){i=n;break}return-1<i?(r[e]=o[i],o[i]):void 0!==o[t]?(h[t]=t,r[e]=o[t],o[t]):null}return u.domain=function(t){if(void 0===t)return h;for(var e=0;e<t.length;e++)h[e]=t[e];return this},u.range=function(t){if(void 0===t)return o;for(var e=0;e<t.length;e++)o[e]=t[e];return this},u.rangePoints=function(t,e){e=e||0;for(var i=h.length,n=(t[1]-t[0]-e)/i,r=[],a=0;a<h.length;a++)r[a]=0==a?t[0]+e/2+n/2:r[a-1]+n;return o=r,c=n,u},u.rangeBands=function(t,e,i){for(var n=h.length-1,r=(t[1]-t[0])/n,a=[],s=0;s<h.length;s++)a[s]=0==s?t[0]:r+a[s-1];return c=r,o=a,u},u.rangeBand=function(){return c},u.invert=function(t){return Math.ceil(t/c)},u},time:function(){var c,u=[],l=x.linear(),i=l.domain;return l.domain=function(t){if(!arguments.length)return i.call(l);for(var e=0;e<t.length;e++)u[e]=+t[e];return i.call(l,u)},l.min=function(){return Math.min(u[0],u[u.length-1])},l.max=function(){return Math.max(u[0],u[u.length-1])},l.rate=function(t,e){return l(l.max()*(t/e))},l.ticks=function(t,e){for(var i=u[0],n=u[1],r=[];i<n;)r.push(new Date(+i)),i=d.add(i,t,e);r.push(new Date(+i));var a=l(r[1]),s=l(r[2]);return c=s-a,r},l.realTicks=function(t,e){var i=u[0],n=u[1],r=[],a=new Date(+i),s=null;for(t==d.years?s=new Date(a.getFullYear(),0,1):t==d.months?s=new Date(a.getFullYear(),a.getMonth(),1):t==d.days||t==d.weeks?s=new Date(a.getFullYear(),a.getMonth(),a.getDate()):t==d.hours?s=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),0,0,0):t==d.minutes?s=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),0,0):t==d.seconds?s=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),0):t==d.milliseconds&&(s=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds())),s=d.add(s,t,e);+s<+n;)r.push(new Date(+s)),s=d.add(s,t,e);var h=l(r[1]),o=l(r[2]);return c=o-h,r},l.rangeBand=function(){return c},l.invert=function(t){var e=x.linear().domain(l.range()).range(l.domain());return new Date(e(t))},l},log:function(t){var e=t||10,h=x.linear(),n=[],r=null,a=null;function i(t){return t<0?-Math.log(Math.abs(t))/Math.log(e):0<t?Math.log(t)/Math.log(e):0}function o(t){return t<0?-Math.pow(e,Math.abs(t)):0<t?Math.pow(e,t):0}function s(t){return Math.pow(e,(t+"").length-1)<t}function c(t){return Math.pow(e,(t+"").length)}function u(t){var e=t;return r<t?e=r:t<a&&(e=a),h(i(e))}return $.extend(u,h),u.log=function(){for(var t=[],e=0;e<n.length;e++)t[e]=i(n[e]);return t},u.domain=function(t){if(!arguments.length)return n;for(var e=0;e<t.length;e++)n[e]=t[e];if(r=Math.max.apply(Math,n),a=Math.min.apply(Math,n),s(r)&&(n[1]=r=c(r)),s(Math.abs(a))){var i=c(Math.abs(a));n[0]=a=a<0?-i:i}return h.domain(u.log()),u},u.base=function(t){return h.domain(u.log()),u},u.invert=function(t){return o(h.invert(t))},u.ticks=function(t,e,i){var n=h.ticks(t,e,i||1e20,!0);n[n.length-1]<h.max()&&n.push(h.max());for(var r=[],a=0,s=n.length;a<s;a++)r[a]=o(n[a]);return r},u},linear:function(){var g=[0,1],i=[0,1],n=!1,r=!1,t={},a=null,s=null,h=null,o=null,c=null,u=null,l=null,d=null,f=0,p=null,m=null;function v(t){if(o<t)return r?v(o):i[0]+Math.abs(t-g[0])*f;if(t<h)return r?v(h):i[0]-Math.abs(t-g[0])*f;var e=(t-g[0])/l;return p(e)}return v.cache=function(){return t},v.min=function(){return Math.min.apply(Math,g)},v.max=function(){return Math.max.apply(Math,g)},v.rangeMin=function(){return Math.min.apply(Math,i)},v.rangeMax=function(){return Math.max.apply(Math,i)},v.rate=function(t,e){return v(v.max()*(t/e))},v.clamp=function(t){r=t||!1},v.domain=function(t){if(!arguments.length)return g;for(var e=0;e<t.length;e++)g[e]=t[e];return h=v.min(),o=v.max(),l=g[1]-g[0],this},v.range=function(t){if(!arguments.length)return i;for(var e=0;e<t.length;e++)i[e]=t[e];return a=y.interpolateRound(i[0],i[1]),s=y.interpolateNumber(i[0],i[1]),c=v.rangeMin(),u=v.rangeMax(),d=Math.abs(u-c),f=d/l,p=n?a:s,this},v.rangeRound=function(t){return n=!0,v.range(t)},v.rangeBand=function(){return m},v.invert=function(t){return x.linear().domain(i).range(g)(t)},v.ticks=function(t,e,i,n){n=n||!1;var r=v.max();if(0==g[0]&&0==g[1])return[];for(var a=y.nice(g[0],g[1],t||10,e||!1),s=[],h=n?a.max:a.min,o=n?a.min:a.max,c=a.spacing,u=y.fixed(c);n?o<=h:h<=o;)s.push(h),h=n?u.minus(h,c):u.plus(h,c);if(n){s[0]!=r&&s.unshift(r);for(var l=0,d=s.length;l<d;l++)s[l]=Math.abs(s[l]-r)}else s[s.length-1]!=o&&o<h&&s.push(o),g[0]>g[1]&&s.reverse();var f=v(s[0]),p=v(s[1]);return m=Math.abs(p-f),s},v}};return x}},N={name:"chart.vector",extend:null,component:function(){return function e(t,i,n){this.x=t||0,this.y=i||0,this.z=n||0,this.add=function(t){return t instanceof e?new e(this.x+t.x,this.y+t.y,this.z+t.z):new e(this.x+t,this.y+t,this.z+t)},this.subtract=function(t){return t instanceof e?new e(this.x-t.x,this.y-t.y,this.z-t.z):new e(this.x-t,this.y-t,this.z-t)},this.multiply=function(t){return t instanceof e?new e(this.x*t.x,this.y*t.y,this.z*t.z):new e(this.x*t,this.y*t,this.z*t)},this.dotProduct=function(t){var e=this.x*t.x+this.y*t.y+this.z*t.z;return Math.acos(e/(this.getMagnitude()*t.getMagnitude()))},this.crossProduct=function(t){return new e(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},this.normalize=function(){var t=this.getMagnitude();this.x/=t,this.y/=t,this.z/=t},this.getMagnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}}}},G={name:"chart.draw",extend:null,component:function(){function t(){this.render=function(){if(!c.typeCheck("function",this.draw))throw new Error("JUI_CRITICAL_ERR: 'draw' method must be implemented");c.typeCheck("function",this.drawBefore)&&this.drawBefore();var t=this.draw();c.typeCheck("function",this.drawAnimate)&&!1!==(this.grid||this.brush||this.widget||this.map).animate&&this.drawAnimate(t);return c.typeCheck("function",this.drawAfter)&&this.drawAfter(t),t},this.format=function(){return((this.grid||this.brush||this.widget).format||this.chart.format).apply(this.chart,arguments)},this.balloonPoints=function(t,e,i,n){var r=[];return"top"==t?(r.push([0,0].join(",")),r.push([e,0].join(",")),r.push([e,i].join(",")),r.push([e/2+n/2,i].join(",")),r.push([e/2,i+n].join(",")),r.push([e/2-n/2,i].join(",")),r.push([0,i].join(",")),r.push([0,0].join(","))):"bottom"==t?(r.push([0,n].join(",")),r.push([e/2-n/2,n].join(",")),r.push([e/2,0].join(",")),r.push([e/2+n/2,n].join(",")),r.push([e,n].join(",")),r.push([e,n+i].join(",")),r.push([0,n+i].join(",")),r.push([0,n].join(","))):("left"==t?(r.push([0,0].join(",")),r.push([e,0].join(",")),r.push([e,i/2-n/2].join(",")),r.push([e+n,i/2].join(",")),r.push([e,i/2+n/2].join(",")),r.push([e,i].join(",")),r.push([0,i].join(","))):"right"==t?(r.push([0,0].join(",")),r.push([e,0].join(",")),r.push([e,i].join(",")),r.push([0,i].join(",")),r.push([0,i/2+n/2].join(",")),r.push([0-n,i/2].join(",")),r.push([0,i/2-n/2].join(","))):(r.push([0,0].join(",")),r.push([e,0].join(",")),r.push([e,i].join(",")),r.push([0,i].join(","))),r.push([0,0].join(","))),r.join(" ")},this.on=function(i,n){var r=this;return this.chart.on(i,function(){if(c.startsWith(i,"axis.")&&c.typeCheck("integer",r.axis.index)){var t=r.chart.axis(r.axis.index),e=arguments[0];c.typeCheck("object",t)&&arguments[1]==r.axis.index&&n.apply(r,[e])}else n.apply(r,arguments)},"render")},this.calculate3d=function(){var t=this.axis.area("width"),e=this.axis.area("height"),i=this.axis.area("x"),n=this.axis.area("y"),r=this.axis.depth,a=this.axis.degree,s=this.axis.perspective,h=arguments;c.typeCheck("integer",a.x)||(a.x=0),c.typeCheck("integer",a.y)||(a.y=0),c.typeCheck("integer",a.z)||(a.z=0);for(var o=0;o<h.length;o++)h[o].perspective=s,h[o].rotate(Math.max(t,e,r),a,i+t/2,n+e/2,r/2)}}var c=z.include("util.base");return t.setup=function(){return{type:null,animate:!1}},t}},U={name:"chart.axis",extend:null,component:function(){function t(a,n,r){var e,i,s=this,h=null,o={},c={},u="",l=null,d="",f=null;function p(t,e){return x.typeCheck("string",t)&&-1<t.indexOf("%")?e*(parseFloat(t.replace("%",""))/100):t}function g(t,e){if(("x"==e||"y"==e||"z"==e)&&!x.typeCheck("object",t[e]))return null;t[e]=t[e]||{},"x"==e?t[e].orient="top"==t[e].orient?"top":"bottom":"y"==e?t[e].orient="right"==t[e].orient?"right":"left":"z"==e?t[e].orient="center":"c"==e&&(t[e].type=t[e].type||"panel",t[e].orient="custom"),t[e].type=t[e].type||"block";var i=z.include("chart.grid."+t[e].type);z.defineOptions(i,t[e]);var n=new i(a,t,t[e]);n.chart=a,n.axis=t,n.grid=t[e],n.svg=a.svg;var r=n.render();return s.isFull3D()||("left"==t[e].orient?r.root.translate(a.area("x")+s.area("x")-t[e].dist,a.area("y")):"right"==t[e].orient?r.root.translate(a.area("x")+s.area("x2")+t[e].dist,a.area("y")):"bottom"==t[e].orient?r.root.translate(a.area("x"),a.area("y")+s.area("y2")+t[e].dist):"top"==t[e].orient?r.root.translate(a.area("x"),a.area("y")+s.area("y")-t[e].dist):r.root&&r.root.translate(a.area("x")+s.area("x"),a.area("y")+s.area("y"))),r.scale.type=t[e].type,r.scale.root=r.root,r.scale}function m(t){var e=s.origin,i=s.buffer,n=Math.ceil(e.length/i);s.page=t<1?1:n<t?n:t,s.start=(s.page-1)*i,s.end=s.start+i,s.end>e.length&&(s.start=e.length-i,s.end=e.length),s.end<=e.length&&(s.start=s.start<0?0:s.start,s.data=e.slice(s.start,s.end),0<e.length&&s.page++)}function v(t,e){var i=s.origin;s.end=e>i.length?i.length:e,s.start=t<0?0:t,s.data=i.slice(s.start,s.end)}function y(t){var e=s.area("y"),i=s.area("x");return t.chartY>e&&t.chartY<e+s.area("height")&&t.chartX>i&&t.chartX<i+s.area("width")&&(t.axisX=t.chartX-i,t.axisY=t.chartY-e,!0)}this.getValue=function(t,e,i){var n=t[r.keymap[e]];return x.typeCheck("undefined",n)?(n=t[e],x.typeCheck("undefined",n)?i:n):n},this.reload=function(t){var e=a.area();x.extend(this,{x:t.x,y:t.y,z:t.z,c:t.c,map:t.map}),c=x.typeCheck("integer",t.padding)?{left:t.padding,right:t.padding,bottom:t.padding,top:t.padding}:t.padding,o=function(t,e){return t.x=p(t.x,a.area("width")),t.y=p(t.y,a.area("height")),t.width=p(t.width,a.area("width")),t.height=p(t.height,a.area("height")),t.x2=t.x+t.width,t.y2=t.y+t.height,t.x+=e.left||0,t.y+=e.top||0,t.x2-=e.right||0,t.y2-=e.bottom||0,t.width=t.x2-t.x,t.height=t.y2-t.y,t}(x.extend(t.area,{x:0,y:0,width:e.width,height:e.height},!0),c),l&&(l.remove(),l=null),u="axis-clip-id-"+a.index+"."+r.index,l=a.svg.clipPath({id:u},function(){a.svg.rect({x:o.x,y:o.y,width:o.width,height:o.height})}),a.appendDefs(l),f&&(f.remove(),f=null),d="axis-clip-rect-id-"+a.index,f=a.svg.clipPath({id:d},function(){a.svg.rect({x:0,y:0,width:o.width,height:o.height})}),a.appendDefs(f),this.root=function(){var t=a.theme("axisBorderWidth"),e=c.left+c.right,i=c.top+c.bottom,n=a.svg.rect({rx:a.theme("axisBorderRadius"),ry:a.theme("axisBorderRadius"),fill:a.theme("axisBackgroundColor"),"fill-opacity":a.theme("axisBackgroundOpacity"),stroke:a.theme("axisBorderColor"),"stroke-width":t,width:o.width+e-t,height:o.height+i-t,x:o.x-c.left,y:o.y-c.top});return n.translate(a.area("x"),a.area("y")),n}(),this.x=g(this,"x"),this.y=g(this,"y"),this.z=g(this,"z"),this.c=g(this,"c"),this.map=function(t,e){if("map"==e&&!x.typeCheck("object",t[e]))return null;t[e]=t[e]||{};var i=z.include("chart.map");z.defineOptions(i,t[e]),null==h&&(h=new i(a,t,t[e])),h.chart=a,h.axis=t,h.map=t[e],h.svg=a.svg;var n=h.render();return n.root.translate(a.area("x")+s.area("x"),a.area("y")+s.area("y")),n.scale.type=t[e].type,n.scale.root=n.root,n.scale}(this,"map"),this.buffer=t.buffer,this.shift=t.shift,this.index=t.index,this.page=t.page,this.start=t.start,this.end=t.end,this.degree=t.degree,this.depth=t.depth,this.perspective=t.perspective},this.area=function(t){return x.typeCheck("undefined",o[t])?o:o[t]},this.padding=function(t){return x.typeCheck("undefined",c[t])?c:c[t]},this.get=function(t){return{area:o,padding:c,clipId:u,clipRectId:d}[t]||r[t]},this.set=function(t,e,i){x.typeCheck("object",e)?!0===i?(n[t]=x.deepClone(e),r[t]=x.deepClone(e)):(x.extend(n[t],e),x.extend(r[t],e)):(n[t]=e,r[t]=e),a.isRender()&&a.render()},this.updateGrid=this.set,this.update=function(t){this.origin=x.typeCheck("array",t)?t:[t],this.page=1,this.start=0,this.end=0,this.screen(1)},this.screen=function(t){m(t),this.end<=this.origin.length&&a.isRender()&&a.render()},this.next=function(){var t=this.origin,e=this.buffer,i=this.shift;this.start+=i;var n=this.start+e>t.length;this.end=n?t.length:this.start+e,this.start=n?t.length-e:this.start,this.start=this.start<0?0:this.start,this.data=t.slice(this.start,this.end),a.isRender()&&a.render()},this.prev=function(){var t=this.origin,e=this.buffer,i=this.shift;this.start-=i;var n=this.start<0;this.end=n?e:this.start+e,this.start=n?0:this.start,this.data=t.slice(this.start,this.end),a.isRender()&&a.render()},this.zoom=function(t,e){t!=e&&(v(t,e),a.isRender()&&a.render())},this.isFull3D=function(){return!x.typeCheck(["undefined","null"],this.z)},x.extend(s,{data:r.data,origin:r.origin,buffer:r.buffer,shift:r.shift,index:r.index,page:r.page,start:r.start,end:r.end,degree:r.degree,depth:r.depth,perspective:r.perspective}),s.origin=s.data,0<s.start||0<s.end?v(s.start,s.end):m(s.page),e=!1,i=r.index,a.on("chart.mousemove",function(t){y(t)?e||(a.emit("axis.mouseover",[t,i]),e=!0):e&&(a.emit("axis.mouseout",[t,i]),e=!1),y(t)&&a.emit("axis.mousemove",[t,i])}),a.on("bg.mousemove",function(t){!y(t)&&e&&(a.emit("axis.mouseout",[t,i]),e=!1)}),a.on("chart.mousedown",function(t){y(t)&&a.emit("axis.mousedown",[t,i])}),a.on("chart.mouseup",function(t){y(t)&&a.emit("axis.mouseup",[t,i])}),a.on("chart.click",function(t){y(t)&&a.emit("axis.click",[t,i])}),a.on("chart.dblclick",function(t){y(t)&&a.emit("axis.dblclick",[t,i])}),a.on("chart.rclick",function(t){y(t)&&a.emit("axis.rclick",[t,i])}),a.on("chart.mousewheel",function(t){y(t)&&a.emit("axis.mousewheel",[t,i])}),s.reload(r)}var x=z.include("util.base");return t.setup=function(){return{extend:null,x:null,y:null,z:null,c:null,map:null,data:[],origin:[],keymap:{},area:{},padding:{top:0,bottom:0,left:0,right:0},buffer:1e4,shift:1,page:1,start:0,end:0,degree:{x:0,y:0,z:0},depth:0,perspective:.9}},t}};z.use([t,P]);var H={name:"chart.map",extend:null,component:function(){function t(){var f=this,p={},r=null,o={},c=1,a=0,s=0;function h(t){for(var e=[],i=0,n=t.length;i<n;i++)if(x.typeCheck("object",t[i])){var r={};x.typeCheck("string",t[i].style)&&(r=s(t[i].style),delete t[i].style);var a=d.createObject({type:null!=t[i].d?"path":"polygon",attr:t[i]});a.attr(x.extend(r,{fill:f.chart.theme("mapPathBackgroundColor"),"fill-opacity":f.chart.theme("mapPathBackgroundOpacity"),stroke:f.chart.theme("mapPathBorderColor"),"stroke-width":f.chart.theme("mapPathBorderWidth"),"stroke-opacity":f.chart.theme("mapPathBorderOpacity")})),e.push({path:a,data:t[i]})}function s(t){for(var e={},i=t.split(";"),n=0;n<i.length;n++)if(-1!=i[n].indexOf(":")){var r=i[n].split(":");e[x.trim(r[0])]=x.trim(r[1])}return e}return e}function g(t){if(x.typeCheck("string",t.id)){for(var e=[],i=t.childNodes,n=0,r=i.length;n<r;n++){var a=i[n],s=a.nodeName.toLowerCase();if(1==a.nodeType)if("g"==s)e=e.concat(g(a));else if("path"==s||"polygon"==s){var h={group:t.id};for(var o in a.attributes){var c=a.attributes[o];c.specified&&m(c.name)&&(h[c.name]=v(c))}x.typeCheck("string",h.id)&&x.extend(h,y(h.id)),e.push(h)}}return e}}function m(t){return"group"==t||"id"==t||"title"==t||"x"==t||"y"==t||"d"==t||"points"==t||"class"==t||"style"==t}function v(t){return"x"==t.name||"y"==t.name?parseFloat(t.value):t.value}function y(t){for(var e=f.axis.data,i=0;i<e.length;i++){if(f.axis.getValue(e[i],"id",null)==t)return e[i]}return null}function e(){for(var t=f.chart.svg.group(),e=function(d){return x.typeCheck("array",p[d])||(p[d]=[],x.ajax({url:d,async:!1,success:function(t){var e=t.responseXML,i=e.getElementsByTagName("svg"),n=e.getElementsByTagName("style");if(1==i.length){for(var r=i[0].childNodes,a=0,s=r.length;a<s;a++){var h=r[a],o=h.nodeName.toLowerCase();if(1==h.nodeType)if("g"==o)p[d]=p[d].concat(g(h));else if("path"==o||"polygon"==o){var c={};for(var u in h.attributes){var l=h.attributes[u];l.specified&&m(l.name)&&(c[l.name]=v(l))}x.typeCheck("string",c.id)&&x.extend(c,y(c.id)),p[d].push(c)}}for(a=0;a<n.length;a++)f.svg.root.element.appendChild(n[a])}},fail:function(){throw new Error("JUI_CRITICAL_ERR: Failed to load resource")}})),h(p[d])}(f.map.path),i=0,n=e.length;i<n;i++){var r=e[i].path,a=e[i].data;t.append(r),x.typeCheck("string",a.id)&&(o[a.id]=e[i])}return t}function u(){var t=f.map.width,e=f.map.height;return{x:(t*c-t)/2+a,y:(e*c-e)/2+s}}this.scale=function(t){if(x.typeCheck("string",t)){var e=null,i=null,n=null,r=null,a=u();if(x.typeCheck("object",o[t])){if(n=o[t].path,null!=(r=o[t].data).x){var s=f.axis.getValue(r,"dx",0);e=(parseFloat(r.x)+s)*c-a.x}if(null!=r.y){var h=f.axis.getValue(r,"dy",0);i=(parseFloat(r.y)+h)*c-a.y}}return{x:e,y:i,path:n,data:r}}},this.scale.each=function(t){for(var e in o)t.apply(this,[e,o[e]])},this.scale.size=function(){return{width:f.map.width,height:f.map.height}},this.scale.scale=function(t){return!t||t<0||(c=t,r.scale(c),this.view(a,s)),c},this.scale.view=function(t,e){var i={x:a,y:s};if(!x.typeCheck("number",t)||!x.typeCheck("number",e))return i;a=t,s=e;var n=u();return r.translate(-n.x,-n.y),{x:a,y:s}},this.draw=function(){var t=this.chart.svg.group();return c=this.map.scale,a=this.map.viewX,s=this.map.viewY,r=e(),t.append(r),1!=this.map.scale&&this.scale.scale(c),0==this.map.viewX&&0==this.map.viewY||this.scale.view(a,s),this.map.hide&&t.attr({visibility:"hidden"}),{root:t,scale:this.scale}},this.drawAfter=function(t){t.root.attr({"clip-path":"url(#"+this.axis.get("clipRectId")+")"}),setTimeout(function(){f.scale.each(function(t,e){!function(t,e){var r=f.chart;function i(t){var e=l.offset(r.root),i=t.pageX-e.left,n=t.pageY-e.top;t.bgX=i,t.bgY=n,t.chartX=i-r.padding("left"),t.chartY=n-r.padding("top")}t.on("click",function(t){i(t),r.emit("map.click",[e,t])}),t.on("dblclick",function(t){i(t),r.emit("map.dblclick",[e,t])}),t.on("contextmenu",function(t){i(t),r.emit("map.rclick",[e,t]),t.preventDefault()}),t.on("mouseover",function(t){i(t),r.emit("map.mouseover",[e,t])}),t.on("mouseout",function(t){i(t),r.emit("map.mouseout",[e,t])}),t.on("mousemove",function(t){i(t),r.emit("map.mousemove",[e,t])}),t.on("mousedown",function(t){i(t),r.emit("map.mousedown",[e,t])}),t.on("mouseup",function(t){i(t),r.emit("map.mouseup",[e,t])})}(e.path,e)})},1)}}var x=z.include("util.base"),l=z.include("util.dom"),d=z.include("util.svg");return t.setup=function(){return{scale:1,viewX:0,viewY:0,hide:!1,path:"",width:-1,height:-1}},t}};z.use(t,P,p,U);var V={name:"chart.builder",extend:"core",component:function(){var C=z.include("util.base"),M=z.include("util.dom"),T=z.include("util.svg"),A=z.include("util.color"),F=z.include("chart.axis"),R=z.include("util.canvas.hidpi");C.resize(function(){for(var t=z.get("chart.builder"),e=0;e<t.length;e++)for(var i=t[e],n=0;n<i.length;n++)C.typeCheck("function",i[n].resize)&&i[n].resize()},1e3);function t(){var r,a,s,o=[],c=[],h=[],u=null,l={},d=!1,f=null,n={render:[],renderAll:[]},p={main:null,buffer:null,sub:null},i={},g=0;function t(r,t){var e=!1;function i(t){var e=M.offset(r.root),i=t.pageX-e.left,n=t.pageY-e.top;if(t.bgX=i,t.bgY=n,t.chartX=i-r.padding("left"),t.chartY=n-r.padding("top"),!(t.chartX<0||t.chartX>r.area("width")||t.chartY<0||t.chartY>r.area("height")))return!0}t.on("click",function(t){i(t)?r.emit("chart.click",[t]):r.emit("bg.click",[t])}),t.on("dblclick",function(t){i(t)?r.emit("chart.dblclick",[t]):r.emit("bg.dblclick",[t])}),t.on("contextmenu",function(t){i(t)?r.emit("chart.rclick",[t]):r.emit("bg.rclick",[t]),t.preventDefault()}),t.on("mousemove",function(t){i(t)?e?r.emit("chart.mousemove",[t]):(r.emit("chart.mouseover",[t]),e=!0):(e&&(r.emit("chart.mouseout",[t]),e=!1),r.emit("bg.mousemove",[t]))}),t.on("mousedown",function(t){i(t)?r.emit("chart.mousedown",[t]):r.emit("bg.mousedown",[t])}),t.on("mouseup",function(t){i(t)?r.emit("chart.mouseup",[t]):r.emit("bg.mouseup",[t])}),t.on("mouseover",function(t){i(t)||r.emit("bg.mouseover",[t])}),t.on("mouseout",function(t){i(t)||r.emit("bg.mouseout",[t])}),t.on("mousewheel",function(t){i(t)?r.emit("chart.mousewheel",[t]):r.emit("bg.mousewheel",[t])})}function m(t,e){if(!C.typeCheck("undefined",e)&&l[e])return"url(#"+l[e]+")";var i="gradient-"+g;t.attr.id=i;var n=T.createObject(t);return u.append(n),C.typeCheck("undefined",e)||(l[e]=i),"url(#"+i+")"}function v(t){if(C.typeCheck("string",t)){if(t=t.replace("url(#","").replace(")",""),l[t])return"url(#"+t+")";if(-1==t.indexOf("pattern-"))return!1;var e=t.split("-"),i=e.pop(),n=z.include("chart."+e.join("."));return!!n&&("function"==typeof(r=n[i])&&(r=r.call(r)),r.attr&&!r.attr.id&&(r.attr.id=t),r=T.createObject(r),u.append(r),"url(#"+(l[t]=t)+")")}if(t.attr.id=t.attr.id||"pattern-"+g,l[t.attr.id])return"url(#"+t.attr.id+")";var r=T.createObject(t);return u.append(r),l[t.attr.id]=t.attr.id,"url(#"+t.attr.id+")"}function y(t){if(C.typeCheck("undefined",t))return"none";if(C.typeCheck("object",t))return"pattern"==t.type?v(t):m(t);if("string"==typeof t){var e=v(t);if(e)return e}var i=A.parse(t);return i==t?t:m(i,t)}function e(t){var e={};C.typeCheck("string",t)?(C.extend(e,z.include("chart.theme."+t)),C.extend(e,f.style)):C.typeCheck("object",t)&&(C.extend(s,f.style),C.extend(s,t),C.extend(e,s)),s=e}function x(t,e){var i=e.match(/{([^{}]+)}/g);if(null!=i)for(var n=0;n<i.length;n++){var r=i[n].substring(1,i[n].length-1);e=e.replace(i[n],t.icon(r))}return e}function w(t){var e=t.svg.size();return{width:C.typeCheck("integer",f.width)?f.width:e.width,height:C.typeCheck("integer",f.height)?f.height:e.height}}function b(e){function t(t){var i=document.createElement("CANVAS");i.width=n.width*r,i.height=n.height*r,i.style.position="absolute",i.style.left="0px",i.style.top="0px",i.style.width=n.width+"px",i.style.height=n.height+"px",i.getContext&&(p[t]=i.getContext("2d"),R.apply(p[t]),"buffer"!=t&&e.root.appendChild(i)),"sub"==t&&(i.on=function(t,e){return i.addEventListener(t,function(t){"function"==typeof e&&e.call(this,t)},!1),this})}var n=w(e),r=R.pixelRatio;for(var i in p)t(i)}function k(t,e){var i=R.pixelRatio,n=w(t),r=p[e];r.restore(),r.clearRect(0,0,n.width*i,n.height*i),r.save(),"main"==e&&r.translate(a.x,a.y)}this.init=function(){g=this.index=z.size(),function(t){var e=(f=C.deepClone(t.options,{data:!0,bind:!0})).padding;r=C.typeCheck("integer",e)?{left:e,right:e,bottom:e,top:e}:e,C.typeCheck("array",f.axis)||(f.axis=[f.axis]),C.typeCheck("array",f.brush)||(f.brush=[f.brush]),C.typeCheck("array",f.widget)||(f.widget=[f.widget]),0==f.axis.length&&f.axis.push({data:[]});for(var i=0;i<f.axis.length;i++){var n=f.axis[i];C.extend(n,f.axis[n.extend],!0)}}(this),e(f.theme),function(t){t.style.position="relative",t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.MozUserSelect="none",t.setAttribute("unselectable","on")}(this.root),this.svg=new T(this.root,{width:f.width,height:f.height,"buffered-rendering":"dynamic"}),f.canvas?(b(this),t(this,M.find(this.root,"CANVAS")[1])):t(this,this.svg.root),function(){var t=f.icon;if(C.typeCheck(["string","array"],t.path)){for(var e=C.typeCheck("string",t.path)?[t.path]:t.path,i=[],n=0;n<e.length;n++){var r=e[n],a="url("+r+") ";-1!=r.indexOf(".eot")?a+="format('embedded-opentype')":-1!=r.indexOf(".woff")?a+="format('woff')":-1!=r.indexOf(".ttf")?a+="format('truetype')":-1!=r.indexOf(".svg")&&(a+="format('svg')"),i.push(a)}var s,h,o="font-family: "+t.type+"; font-weight: normal; font-style: normal; src: "+i.join(",");s="@font-face {"+o+"}",((h=document.createElement("style")).appendChild(document.createTextNode("")),document.head.appendChild(h),h.sheet).insertRule(s,0)}}(),this.render()},this.get=function(t,e){var i={axis:o,brush:c,widget:h,padding:r,area:a};return i[t][e]?i[t][e]:i[t]||i},this.axis=function(t){return 0==arguments.length?o:o[t]},this.area=function(t){return C.typeCheck("undefined",a[t])?a:a[t]},this.padding=function(t){return C.typeCheck("undefined",r[t])?r:r[t]},this.color=function(n,t){var e=null;if(1==arguments.length?C.typeCheck("string",n)?e=n:C.typeCheck("integer",n)&&(e=i(n)):C.typeCheck(["array","object"],t)?(e=t[n],C.typeCheck("integer",e)&&(e=i(e))):e=i(),l[e])return"url(#"+l[e]+")";function i(t){var e=s.colors,i=t||n;return i>e.length-1?e[e.length-1]:e[i]}return y(e)},this.icon=function(t){return z.include("chart.icon."+f.icon.type)[t]},this.text=function(t,e){return C.typeCheck("string",e)?e=x(this,e):C.typeCheck("undefined",e)&&(e=""),this.svg.text(t,e)},this.texts=function(t,e,i){for(var n=this.svg.group(),r=0;r<e.length;r++)if(C.typeCheck("string",e[r])){var a=(t["font-size"]||10)*(i||1);n.append(this.svg.text(C.extend({y:r*a},t,!0),x(this,e[r])))}return n},this.theme=function(t,e,i){if(0==arguments.length)return s;if(1==arguments.length)return-1<t.indexOf("Color")&&null!=s[t]?y(s[t]):s[t];if(3==arguments.length){var n=t?e:i;return-1<n.indexOf("Color")&&null!=s[n]?y(s[n]):s[n]}},this.format=function(){if(0!=arguments.length){var t=f.format;return C.typeCheck("function",t)?t.apply(this,arguments):arguments[0]}},this.on=function(t,e,i){C.typeCheck("string",t)&&C.typeCheck("function",e)&&(this.event.push({type:t.toLowerCase(),callback:e}),"render"!=i&&"renderAll"!=i||n[i].push(e))},this.render=function(t){this.svg.reset(t),function(t,e){for(var i=0;i<n.render.length;i++)t.off(n.render[i]);if(n.render=[],!0===e){for(i=0;i<n.renderAll.length;i++)t.off(n.renderAll[i]);n.renderAll=[]}}(this,t),function(t){var e=t.svg.size(),i={width:e.width-(r.left+r.right),height:e.height-(r.top+r.bottom),x:r.left,y:r.top};i.width<0&&(i.width=0),i.height<0&&(i.height=0),i.x2=i.x+i.width,i.y2=i.y+i.height,a=i}(this),this.options.canvas&&(k(this,"main"),k(this,"buffer"),t&&k(this,"sub")),function(t){c=C.deepClone(f.brush),h=C.deepClone(f.widget),u=t.svg.defs(),l={}}(this),function(t){for(var e=C.deepClone(f.axis,{data:!0,origin:!0}),i=0;i<e.length;i++)z.defineOptions(F,e[i]),e[i].index=i,o[i]?o[i].reload(e[i]):o[i]=new F(t,f.axis[i],e[i])}(this),function(t){var e=c;if(null!=e)for(var i=0;i<e.length;i++){var n=z.include("chart.brush."+e[i].type);z.defineOptions(n,e[i]);var r=o[e[i].axis];if(e[i].target)C.typeCheck("string",e[i].target)&&(e[i].target=[e[i].target]);else{var a=[];if(r)for(var s in r.data[0])a.push(s);e[i].target=a}e[i].index=i;var h=new n(t,r,e[i]);h.chart=t,h.axis=r,h.brush=e[i],h.svg=t.svg,h.canvas=p.buffer,h.render()}}(this),function(t,e){var i=h;if(null!=i)for(var n=0;n<i.length;n++){var r=z.include("chart.widget."+i[n].type);z.defineOptions(r,i[n]),i[n].index=n;var a=new r(t,o[0],i[n]);if(a.chart=t,a.axis=o[0],a.widget=i[n],a.svg=t.svg,a.canvas=p.sub,d&&!a.isRender()&&!0!==e)return;var s=a.render();a.isRender()||t.svg.autoRender(s,!1)}}(this,t),this.options.canvas&&p.main.drawImage(p.buffer.canvas,0,0),this.svg.root.css({"font-family":this.theme("fontFamily")+","+f.icon.type,background:this.theme("backgroundColor")}),this.svg.render(t),this.emit("render",[d]),d=!0},this.appendDefs=function(t){u.append(t)},this.addBrush=function(t){f.brush.push(t),this.isRender()&&this.render()},this.removeBrush=function(t){f.brush.splice(t,1),this.isRender()&&this.render()},this.updateBrush=function(t,e,i){!0===i?f.brush[t]=e:C.extend(f.brush[t],e),this.isRender()&&this.render()},this.addWidget=function(t){f.widget.push(t),this.isRender()&&this.render()},this.removeWidget=function(t){f.widget.splice(t,1),this.isRender()&&this.render()},this.updateWidget=function(t,e,i){!0===i?f.widget[t]=e:C.extend(f.widget[t],e),this.isRender()&&this.render()},this.setTheme=function(t){e(t),this.isRender()&&this.render(!0)},this.setSize=function(t,e){if(2==arguments.length&&(f.width=t,f.height=e),this.svg.size(f.width,f.height),f.canvas)for(var i=R.pixelRatio,n=M.find(this.root,"CANVAS"),r=w(this),a=0;a<n.length;a++)n[a].width=r.width*i,n[a].height=r.height*i,n[a].style.width=r.width+"px",n[a].style.height=r.height+"px";this.isRender()&&this.render(!0)},this.isFullSize=function(){return"100%"==f.width||f.height,!0},this.resize=function(){this.isFullSize()&&this.setSize(),this.isRender()||this.render(!0)},this.isRender=function(){return!d||f.render},this.setCache=function(t,e){i[t]=e},this.getCache=function(t,e){return void 0===i[t]?e:i[t]}}return t.setup=function(){return{width:"100%",height:"100%",padding:{top:50,bottom:50,left:50,right:50},theme:"classic",style:{},brush:[],widget:[],axis:[],bind:null,format:null,render:!0,icon:{type:"classic",path:null},canvas:!1}},t}},J={name:"chart.plane",extend:"core",component:function(){function t(){var n=null,r=[],a=[],s=[],h=0,o={},c={};this.init=function(){var t=this.options,e={type:"range",step:t.step,line:t.line};o.x=u.extend({domain:t.x},e),o.y=u.extend({domain:t.y},e),o.x.orient="bottom",o.y.orient="left",o.z=u.extend({domain:t.z},e),o.depth=t.depth-2*t.padding,o.degree={x:t.dx,y:t.dy,z:t.dz},o.perspective=t.perspective,c.extend=0,c.x={hide:!0},c.y={hide:!0},c.z={hide:!0},"2d"==t.dimension&&(o.perspective=1,o.degree.x=0,o.degree.y=0,o.degree.z=0,o.z.hideText=!0)},this.push=function(t){u.typeCheck("array",t)&&(r[h]||r.push(u.extend({},0==h?o:c)),r[h].data||(r[h].data=[]),r[h].data.push(t))},this.commit=function(t,e){var i=this.options;a.push({type:"canvas.dot3d",color:h,axis:h,symbol:t||i.symbol,size:2*(e||i.r)}),h++},this.append=function(t,e,i){var n=this.options;r.push(u.extend({},0==h?o:c)),r[h].data=t,a.push({type:"canvas.dot3d",color:h,axis:h,symbol:e||n.symbol,size:2*(i||n.r)}),h++},this.render=function(){var t=this.options;if("3d"==t.dimension&&s.push({type:"polygon.rotate3d"}),null!=n&&(n.root.innerHTML="",n=null),0==r.length&&r.push(o),n=l(this.root,{padding:t.padding,width:t.width,height:t.height,axis:r,brush:a,widget:s,canvas:!0,render:!1,style:{gridFaceBackgroundOpacity:.1}}),u.typeCheck("array",t.colors)){for(var e=[],i=0;i<t.colors.length;i++)e.push(n.color(t.colors[i]));n.setTheme({colors:e})}r=[],a=[],s=[],h=0,n.render()}}var u=z.include("util.base"),l=z.include("chart.builder");return t.setup=function(){return{dimension:"2d",width:500,height:500,depth:500,padding:50,x:[-100,100],y:[-100,100],z:[-100,100],step:4,line:!0,symbol:"dot",r:2,perspective:.9,dx:10,dy:5,dz:0,colors:null}},t}},q={name:"chart.animation",extend:"core",component:function(){function t(){var r=void 0,a=-1,s=0,h=0;this.init=function(){var t=this.options;if(r=t.interval,delete t.interval,t.axis.length&&1<t.axis.length)throw new Error("JUI_CRITICAL_ERR: the real-time module allows only a single axes");this.builder=i(this.selector,t)},this.run=function(t){var e=this,i=Date.now();if(0==h&&(h=i),r<i-s||0==r){var n=(i-s)/1e3;1<n&&(n=1),this.builder.setCache("tpf",n),this.builder.setCache("fps",1/n),"function"==typeof t&&t.call(this,i-h),this.render(),s=i}a=requestAnimationFrame(function(){e.run(t)})},this.stop=function(){-1!=a&&(cancelAnimationFrame(a),a=-1)},this.set=function(t,e,i){this.builder.axis(0).set(t,e,i)},this.update=function(t){this.builder.axis(0).update(t)},this.render=function(t){this.builder.render(t)}}var e=z.include("util.base"),i=z.include("chart.builder");return t.setup=function(){return e.extend({render:!1,canvas:!0,interval:0},V.component().setup(),!0)},t}};z.use([N,b,f]);var Z={name:"chart.polygon.core",extend:null,component:function(){var p=z.include("util.base"),g=z.include("chart.vector"),m=z.include("util.transform"),v=z.include("util.math");return function(){this.perspective=.9,this.rotate=function(t,e,i,n,r){var a=this.perspective,s=new m(this.vertices),h=s.matrix("move3d",i,n,r);h=v.matrix3d(h,s.matrix("rotate3dx",e.x)),h=v.matrix3d(h,s.matrix("rotate3dy",e.y)),h=v.matrix3d(h,s.matrix("rotate3dz",e.z)),h=v.matrix3d(h,s.matrix("move3d",-i,-n,-r)),this.vertices=s.custom(h);for(var o=0,c=this.vertices.length;o<c;o++){var u=Math.abs(this.vertices[o][2]-t),l=v.scaleValue(u,0,t,a,1),d=new m,f=d.matrix("move3d",i,n,t/2);f=v.matrix3d(f,d.matrix("scale3d",l,l,l)),f=v.matrix3d(f,d.matrix("move3d",-i,-n,-t/2)),this.vertices[o]=v.matrix3d(f,this.vertices[o]),p.typeCheck("array",this.vectors)&&(null==this.vectors[o]?this.vectors[o]=new g(this.vertices[o][0],this.vertices[o][1],this.vertices[o][2]):(this.vectors[o].x=this.vertices[o][0],this.vectors[o].y=this.vertices[o][1],this.vectors[o].z=this.vertices[o][2]))}},this.min=function(){for(var t={x:this.vertices[0][0],y:this.vertices[0][1],z:this.vertices[0][2]},e=1,i=this.vertices.length;e<i;e++)t.x=Math.min(t.x,this.vertices[e][0]),t.y=Math.min(t.y,this.vertices[e][1]),t.z=Math.min(t.z,this.vertices[e][2]);return t},this.max=function(){for(var t={x:this.vertices[0][0],y:this.vertices[0][1],z:this.vertices[0][2]},e=1,i=this.vertices.length;e<i;e++)t.x=Math.max(t.x,this.vertices[e][0]),t.y=Math.max(t.y,this.vertices[e][1]),t.z=Math.max(t.z,this.vertices[e][2]);return t}}}};z.use(Z);var K={name:"chart.polygon.grid",extend:"chart.polygon.core",component:function(){return function(t,e,i,n,r,a){e=(r=r||0)+e,i=(a=a||0)+i;var s={center:[new Float32Array([r,a,n,1]),new Float32Array([e,a,n,1]),new Float32Array([e,i,n,1]),new Float32Array([r,i,n,1])],horizontal:[new Float32Array([r,i,0,1]),new Float32Array([e,i,0,1]),new Float32Array([e,i,n,1]),new Float32Array([r,i,n,1])],vertical:[new Float32Array([e,a,0,1]),new Float32Array([e,i,0,1]),new Float32Array([e,i,n,1]),new Float32Array([e,a,n,1])]};this.vertices=s[t],this.vectors=[]}}};z.use(Z);var Q={name:"chart.polygon.line",extend:"chart.polygon.core",component:function(){return function(t,e,i,n,r,a){this.vertices=[new Float32Array([t,e,i,1]),new Float32Array([n,r,a,1])],this.vectors=[]}}};z.use(Z);var tt={name:"chart.polygon.point",extend:"chart.polygon.core",component:function(){return function(t,e,i){this.vertices=[new Float32Array([t,e,i,1])],this.vectors=[]}}};z.use(Z);var et={name:"chart.polygon.cube",extend:"chart.polygon.core",component:function(){return function(t,e,i,n,r,a){this.vertices=[new Float32Array([t,e,i,1]),new Float32Array([t+n,e,i,1]),new Float32Array([t+n,e,i+a,1]),new Float32Array([t,e,i+a,1]),new Float32Array([t,e+r,i,1]),new Float32Array([t+n,e+r,i,1]),new Float32Array([t+n,e+r,i+a,1]),new Float32Array([t,e+r,i+a,1])],this.faces=[[0,1,2,3],[3,2,6,7],[0,3,7,4],[1,2,6,5],[0,1,5,4],[4,5,6,7]],this.vectors=[]}}};z.use(G);var it={name:"chart.grid.draw2d",extend:"chart.draw",component:function(){var u=z.include("util.base");return function(){this.createGridX=function(t,e,i,n,r){var a=this.getLineOption(),s=this.chart.svg.group().translate(i,0),h=this.chart.theme("gridTickBorderSize");return s.append(this.line({y2:"bottom"==t?h:-h,stroke:this.color(n,"gridActiveBorderColor","gridXAxisBorderColor"),"stroke-width":this.chart.theme("gridTickBorderWidth")})),a&&this.drawValueLine(t,s,n,a,e,r),s},this.createGridY=function(t,e,i,n,r){var a=this.getLineOption(),s=this.chart.svg.group().translate(0,i),h=this.chart.theme("gridTickBorderSize");return s.append(this.line({x2:"left"==t?-h:h,stroke:this.color(n,"gridActiveBorderColor","gridYAxisBorderColor"),"stroke-width":this.chart.theme("gridTickBorderWidth")})),a&&this.drawValueLine(t,s,n,a,e,r),s},this.fillRectObject=function(t,e,i,n,r,a,s){-1<e.type.indexOf("gradient")?t.append(this.chart.svg.rect({x:n,y:r,height:s,width:a,fill:this.chart.color(e.fill?e.fill:"linear("+i+") "+this.chart.theme("gridPatternColor")+",0.5 "+this.chart.theme("backgroundColor")),"fill-opacity":this.chart.theme("gridPatternOpacity")})):-1<e.type.indexOf("rect")&&t.append(this.chart.svg.rect({x:n,y:r,height:s,width:a,fill:this.chart.color(e.fill?e.fill:this.chart.theme("gridPatternColor")),"fill-opacity":this.chart.theme("gridPatternOpacity")}))},this.drawAxisLine=function(t,e,i){var n="top"==t||"bottom"==t;e.append(this.chart.svg.line(u.extend({x1:0,y1:0,x2:0,y2:0,stroke:this.color(n?"gridXAxisBorderColor":"gridYAxisBorderColor"),"stroke-width":this.chart.theme(n?"gridXAxisBorderWidth":"gridYAxisBorderWidth"),"stroke-opacity":1},i)))},this.drawPattern=function(t,e,i,n){if(!this.grid.hide&&t&&e&&i){var r=this.getLineOption(),a="left"==t||"right"==t,s=this.chart.svg.group();if(s.translate(this.axis.area("x")+this.chart.area("x"),this.axis.area("y")+this.chart.area("y")),r&&(-1<r.type.indexOf("gradient")||-1<r.type.indexOf("rect")))for(var h=0;h<i.length-1;h+=2){var o=Math.abs(i[h+1]-i[h]),c=i[h]-(n?o/2:0),u=a?0:c,l=a?c:0,d=a?this.axis.area("width"):o,f=a?o:this.axis.area("height");this.fillRectObject(s,r,t,u,l,d,f)}}},this.drawBaseLine=function(t,e){var i=this.getGridSize(),n={};"bottom"==t||"top"==t?n={x1:i.start,x2:i.end}:"left"!=t&&"right"!=t||(n={y1:i.start,y2:i.end}),this.drawAxisLine(t,e,n)},this.drawValueLine=function(t,e,i,n,r,a){var s={},h=!1;if("top"==t?(h=this.checkDrawLineY(r,a),s={x1:0,x2:0,y1:0,y2:this.axis.area("height")}):"bottom"==t?(h=this.checkDrawLineY(r,a),s={x1:0,x2:0,y1:0,y2:-this.axis.area("height")}):"left"==t?(h=this.checkDrawLineX(r,a),s={x1:0,x2:this.axis.area("width"),y1:0,y2:0}):"right"==t&&(h=this.checkDrawLineX(r,a),s={x1:0,x2:-this.axis.area("width"),y1:0,y2:0}),h){var o=this.line(u.extend({stroke:this.chart.theme(i,"gridActiveBorderColor","gridBorderColor"),"stroke-width":this.chart.theme(i,"gridActiveBorderWidth","gridBorderWidth")},s));if(-1<n.type.indexOf("dashed")){var c=this.chart.theme("gridBorderDashArray");o.attr({"stroke-dasharray":"none"!=c&&c?c:"3,3"})}e.append(o)}},this.drawValueText=function(t,e,i,n,r,a,s){this.grid.hideText||("top"==t?e.append(this.getTextRotate(this.chart.text({x:a,y:-(this.chart.theme("gridTickBorderSize")+2*this.chart.theme("gridTickPadding")),dy:this.chart.theme("gridXFontSize")/3,fill:this.chart.theme(s,"gridActiveFontColor","gridXFontColor"),"text-anchor":"middle","font-size":this.chart.theme("gridXFontSize"),"font-weight":this.chart.theme("gridXFontWeight")},r))):"bottom"==t?e.append(this.getTextRotate(this.chart.text({x:a,y:this.chart.theme("gridTickBorderSize")+2*this.chart.theme("gridTickPadding"),dy:this.chart.theme("gridXFontSize")/3,fill:this.chart.theme(s,"gridActiveFontColor","gridXFontColor"),"text-anchor":"middle","font-size":this.chart.theme("gridXFontSize"),"font-weight":this.chart.theme("gridXFontWeight")},r))):"left"==t?e.append(this.getTextRotate(this.chart.text({x:-this.chart.theme("gridTickBorderSize")-this.chart.theme("gridTickPadding"),y:a,dy:this.chart.theme("gridYFontSize")/3,fill:this.chart.theme(s,"gridActiveFontColor","gridYFontColor"),"text-anchor":"end","font-size":this.chart.theme("gridYFontSize"),"font-weight":this.chart.theme("gridYFontWeight")},r))):"right"==t&&e.append(this.getTextRotate(this.chart.text({x:this.chart.theme("gridTickBorderSize")+this.chart.theme("gridTickPadding"),y:a,dy:this.chart.theme("gridYFontSize")/3,fill:this.chart.theme(s,"gridActiveFontColor","gridYFontColor"),"text-anchor":"start","font-size":this.chart.theme("gridYFontSize"),"font-weight":this.chart.theme("gridYFontWeight")},r))))},this.drawImage=function(t,e,i,n,r,a){if(u.typeCheck("function",this.grid.image)){var s=this.grid.image.apply(this.chart,[i,n]);if(u.typeCheck("object",s)){var h=this.chart.svg.image({"xlink:href":s.uri,width:s.width,height:s.height});"top"==t||"bottom"==t?h.attr({x:"block"==this.grid.type?this.scale.rangeBand()/2-s.width/2:-s.width/2}):"left"!=t&&"right"!=t||h.attr({y:"block"==this.grid.type?this.scale.rangeBand()/2-s.height/2:-s.height/2}),"bottom"==t?h.attr({y:s.dist}):"top"==t?h.attr({y:-(s.dist+s.height)}):"left"==t?h.attr({x:-(s.dist+s.width)}):"right"==t&&h.attr({x:s.dist}),h.translate(r,a),e.append(h)}}}}}};z.use(G,K,Q,tt);var nt={name:"chart.grid.draw3d",extend:"chart.draw",component:function(){z.include("util.base");var f=z.include("chart.polygon.grid"),x=z.include("chart.polygon.line"),v=z.include("chart.polygon.point");return function(){this.createGridX=function(t,e,i,n,r){var a=this.getLineOption(),s=this.svg.group();return a&&this.drawValueLine(t,s,n,a,e,i,r),s},this.createGridY=function(t,e,i,n,r){var a=this.getLineOption(),s=this.svg.group();return a&&this.drawValueLine(t,s,n,a,e,i,r),s},this.drawCenter=function(t,e,i,n,r){var a=this.svg.group(),s=this.getLineOption();s&&this.drawValueLineCenter(a,e,s),this.drawValueTextCenter(a,e,i,n,r),t.append(a)},this.drawBaseLine=function(t,e){var i=this.svg.group();this.drawAxisLine(t,i),e.append(i)},this.drawAxisLine=function(t,e){var i="top"==t||"bottom"==t,n=i?"gridXAxisBorderColor":"gridYAxisBorderColor",r=i?"gridXAxisBorderWidth":"gridYAxisBorderWidth";"center"==t&&(n="gridZAxisBorderColor",r="gridZAxisBorderWidth");var a=this.svg.polygon({stroke:this.chart.theme(n),"stroke-width":this.chart.theme(r),"stroke-opacity":1,fill:this.chart.theme("gridFaceBackgroundColor"),"fill-opacity":this.chart.theme("gridFaceBackgroundOpacity")}),s=null,h=this.axis.area("width"),o=this.axis.area("height"),c=this.axis.area("x"),u=this.axis.area("y"),l=this.axis.depth;s="center"==t?new f("center",h,o,l,c,u):i?new f("horizontal",h,o="bottom"==t?o:0,l,c,u):new f("vertical",h="right"==t?h:0,o,l,c,u),this.calculate3d(s);for(var d=0;d<s.vectors.length;d++)a.point(s.vectors[d].x,s.vectors[d].y);"center"==t?!0!==this.axis.get("y").hide&&e.append(a):e.append(a)},this.drawValueLine=function(t,e,i,n,r,a,s){var h=!1,o=this.axis.area("width"),c=this.axis.area("height"),u=this.axis.area("x"),l=this.axis.area("y"),d=this.axis.depth,f=null,p=null;if("top"==t?(h=this.checkDrawLineY(r,s),f=new x(a,l,0,a,l,d),p=new x(a,l,d,a,l+c,d)):"bottom"==t?(h=this.checkDrawLineY(r,s),f=new x(a,l+c,0,a,l+c,d),p=new x(a,l+c,d,a,l,d)):"left"==t?(h=this.checkDrawLineX(r,s),f=new x(u,a,0,u,a,d),p=new x(u,a,d,u+o,a,d)):"right"==t&&(h=this.checkDrawLineX(r,s),f=new x(u+o,a,0,u+o,a,d),p=new x(u+o,a,d,u,a,d)),h){this.calculate3d(f,p);var g=this.line({stroke:this.chart.theme("gridBorderColor"),"stroke-width":this.chart.theme("gridBorderWidth"),x1:f.vectors[0].x,y1:f.vectors[0].y,x2:f.vectors[1].x,y2:f.vectors[1].y}),m=this.line({stroke:this.chart.theme("gridBorderColor"),"stroke-width":this.chart.theme("gridBorderWidth"),x1:p.vectors[0].x,y1:p.vectors[0].y,x2:p.vectors[1].x,y2:p.vectors[1].y});if(-1<n.type.indexOf("dashed")){var v=this.chart.theme("gridBorderDashArray"),y="none"!=v&&v?v:"3,3";g.attr({"stroke-dasharray":y}),m.attr({"stroke-dasharray":y})}e.append(g),!0!==this.axis.get("y").hide&&e.append(m)}},this.drawValueLineCenter=function(t,e,i){for(var n="block"!=this.grid.type?e.length-1:e.length,r=this.axis.area("width"),a=this.axis.area("height"),s=this.axis.area("x"),h=this.axis.area("y"),o=this.axis.depth,c="left"==this.axis.get("y").orient?0:r,u="top"==this.axis.get("x").orient?0:a,l=1;l<n;l++){var d=l*(o/n),f=new x(s,h+u,d,s+r,h+u,d),p=new x(s+c,h,d,s+c,h+a,d);this.calculate3d(f,p);var g=this.line({stroke:this.chart.theme("gridBorderColor"),"stroke-width":this.chart.theme("gridBorderWidth"),x1:f.vectors[0].x,y1:f.vectors[0].y,x2:f.vectors[1].x,y2:f.vectors[1].y}),m=this.line({stroke:this.chart.theme("gridBorderColor"),"stroke-width":this.chart.theme("gridBorderWidth"),x1:p.vectors[0].x,y1:p.vectors[0].y,x2:p.vectors[1].x,y2:p.vectors[1].y});if(-1<i.type.indexOf("dashed")){var v=this.chart.theme("gridBorderDashArray"),y="none"!=v&&v?v:"3,3";g.attr({"stroke-dasharray":y}),m.attr({"stroke-dasharray":y})}t.append(g),!0!==this.axis.get("y").hide&&t.append(m)}},this.drawValueText=function(t,e,i,n,r){if(!this.grid.hideText){var a="left"==t||"right"==t,s=this.chart.theme("gridTickBorderSize"),h=this.chart.theme("gridTickPadding"),o=this.axis.area("width"),c=this.axis.area("height"),u=this.axis.area("x"),l=this.axis.area("y"),d=0,f=0;"top"==t?(d=n,f=l+-(s+2*h)):"bottom"==t?(d=n,f=l+(c+s+2*h)):"left"==t?(d=u+-(s+h),f=n):"right"==t&&(d=u+(o+s+h),f=n);var p=new v(d,f,0);this.calculate3d(p),e.append(this.getTextRotate(this.chart.text({x:p.vectors[0].x,y:p.vectors[0].y,dx:a?0:this.chart.theme("gridXFontSize")/3,dy:a?this.chart.theme("gridYFontSize")/3:0,fill:this.chart.theme(a?"gridYFontColor":"gridXFontColor"),"text-anchor":a?"left"==t?"end":"start":"middle","font-size":this.chart.theme(a?"gridYFontSize":"gridXFontSize"),"font-weight":this.chart.theme(a?"gridYFontWeight":"gridXFontWeight")},r)))}},this.drawValueTextCenter=function(t,e,i,n,r){if(!this.grid.hideText)for(var a=this.chart.theme("gridTickBorderSize")+this.chart.theme("gridTickPadding"),s="left"==this.axis.get("y").orient,h="top"==this.axis.get("x").orient,o="block"!=this.grid.type?e.length-1:e.length,c=this.axis.area("width"),u=this.axis.area("height"),l=this.axis.depth,d=this.axis.area("x")+(s?c+a:-a),f=this.axis.area("y")+(h?-a:u+a),p=0;p<e.length;p++){var g=this.format(e[p],p),m=new v(d,f,p*(l/o)+r);this.calculate3d(m),t.append(this.getTextRotate(this.chart.text({x:m.vectors[0].x,y:m.vectors[0].y,fill:this.chart.theme("gridZFontColor"),"text-anchor":s?"start":"end","font-size":this.chart.theme("gridZFontSize"),"font-weight":this.chart.theme("gridZFontWeight")},g)))}},this.drawPattern=function(){},this.drawImage=function(){}}}};z.use([f,G,it,nt]);var rt={name:"chart.grid.core",extend:"chart.draw",component:function(){function t(){this.wrapper=function(t,e){return t},this.line=function(t){return this.chart.svg.line(d.extend({x1:0,y1:0,x2:0,y2:0,stroke:this.color("gridBorderColor"),"stroke-width":this.chart.theme("gridBorderWidth"),"stroke-dasharray":this.chart.theme("gridBorderDashArray"),"stroke-opacity":this.chart.theme("gridBorderOpacity")},t))},this.color=function(t){var e=this.grid.color;return 3==arguments.length?null!=e?this.chart.color(e):this.chart.theme.apply(this.chart,arguments):null!=e?this.chart.color(e):this.chart.theme(t)},this.data=function(t,e){return this.axis.data&&this.axis.data[t]?this.axis.data[t][e]||this.axis.data[t]:this.axis.data||[]},this.getGridSize=function(){var t=this.grid.orient,e=this.axis.depth,i=this.axis.degree,n="left"==t||"right"==t?this.axis.area("y"):this.axis.area("x"),r="left"==t||"right"==t?this.axis.area("height"):this.axis.area("width"),a={start:n,size:r,end:n+r};if(this.axis.isFull3D())"center"==t&&(a.start=0,a.size=e,a.end=e);else if(0<e||0<i){var s=c.radian(360-i),h=Math.cos(s)*e,o=Math.sin(s)*e;"left"==t?(a.start=a.start-o,a.size=a.size-o):"bottom"==t&&(a.end=a.end-h,a.size=a.size-h)}return a},this.getDefaultOffset=function(){var t=this.grid.orient,e=this.axis.area(),i=e.width,n=e.height,r="left"==t||"right"==t?e.y:e.x,a="left"==t||"right"==t?n:i;return{start:r,size:a,end:r+a}},this.getTextRotate=function(t){var e=this.grid.textRotate;if(null==e)return t;d.typeCheck("function",e)&&(e=e.apply(this.chart,[t]));var i=t.attr("x"),n=t.attr("y");return t.rotate(e,i,n),t},this.getLineOption=function(){var t=this.grid.line;return"string"==typeof t?t={type:t||"solid"}:"number"==typeof t?t={type:"solid","stroke-width":t}:"object"!==(void 0===t?"undefined":l(t))&&(t=(t=!!t)&&{type:"solid"}),t&&"string"==!t.type&&(t.type=t.type.split(/ /g)),t},this.checkDrawLineY=function(t,e){var i=this.axis.get("y");if(!i.hide){if("left"==i.orient&&0==t&&!this.grid.realtime)return!1;if("right"==i.orient&&e)return!1}return!0},this.checkDrawLineX=function(t,e){var i=this.axis.get("x");if(!i.hide){if("top"==i.orient&&0==t)return!1;if("bottom"==i.orient&&e&&!this.grid.realtime)return!1}return!0},this.drawTop=function(t,e,i,n,r){for(var a=0,s=e.length;a<s;a++){var h=this.format(e[a],a),o=i[a]-r,c=a==s-1&&"block"!=this.grid.type,u=!1;if(this.drawImage("top",t,e[a],a,o,0),h||0===h){d.typeCheck("function",n)&&(u=n(e[a]));var l=this.createGridX("top",a,o,u,c);this.drawValueText("top",l,a,i[a],h,r,u),t.append(l)}}},this.drawBottom=function(t,e,i,n,r){for(var a=0,s=e.length;a<s;a++){var h=this.format(e[a],a),o=i[a]-r,c=a==s-1&&"block"!=this.grid.type,u=!1;if(this.drawImage("bottom",t,e[a],a,o,0),h||0===h){d.typeCheck("function",n)&&(u=n(e[a]));var l=this.createGridX("bottom",a,o,u,c);this.drawValueText("bottom",l,a,i[a],h,r,u),t.append(l)}}},this.drawLeft=function(t,e,i,n,r){for(var a=0,s=e.length;a<s;a++){var h=this.format(e[a],a),o=i[a]-r,c=a==s-1&&"block"!=this.grid.type,u=!1;if(this.drawImage("left",t,e[a],a,0,o),h||0===h){d.typeCheck("function",n)&&(u=n(e[a]));var l=this.createGridY("left",a,o,u,c);this.drawValueText("left",l,a,i[a],h,r,u),t.append(l)}}},this.drawRight=function(t,e,i,n,r){for(var a=0,s=e.length;a<s;a++){var h=this.format(e[a],a),o=i[a]-r,c=a==s-1&&"block"!=this.grid.type,u=!1;if(this.drawImage("right",t,e[a],a,0,o),h||0===h){d.typeCheck("function",n)&&(u=n(e[a]));var l=this.createGridY("right",a,o,u,c);this.drawValueText("right",l,a,i[a],h,r,u),t.append(l)}}},this.drawGrid=function(){var t=this.chart.svg.group(),e=this[this.grid.orient],i=this.axis.isFull3D()?r:n;return this.scale=this.wrapper(this.scale,this.grid.key),d.typeCheck("function",e)&&(i.call(this),e.call(this,t)),this.grid.hide&&t.attr({display:"none"}),{root:t,scale:this.scale}},this.drawAfter=function(t){t.root.attr({class:"grid-"+this.grid.type}),t.root.translate(this.chart.area("x"),this.chart.area("y"))}}var d=z.include("util.base"),c=z.include("util.math"),n=z.include("chart.grid.draw2d"),r=z.include("chart.grid.draw3d");return t.setup=function(){return{dist:0,orient:null,hide:!1,color:null,title:null,line:!1,format:null,image:null,textRotate:null}},t}},at={name:"chart.grid.block",extend:"chart.grid.core",component:function(){function t(){this.center=function(t){this.drawCenter(t,this.domain,this.points,null,this.half_band),this.drawBaseLine("center",t)},this.top=function(t){this.drawPattern("top",this.domain,this.points,!0),this.drawTop(t,this.domain,this.points,null,this.half_band),this.drawBaseLine("top",t),t.append(this.createGridX("top",this.domain.length,this.end,null,!0))},this.bottom=function(t){this.drawPattern("bottom",this.domain,this.points,!0),this.drawBottom(t,this.domain,this.points,null,this.half_band),this.drawBaseLine("bottom",t),t.append(this.createGridX("bottom",this.domain.length,this.end,null,!0))},this.left=function(t){this.drawPattern("left",this.domain,this.points,!0),this.drawLeft(t,this.domain,this.points,null,this.half_band),this.drawBaseLine("left",t),t.append(this.createGridY("left",this.domain.length,this.end,null,!0))},this.right=function(t){this.drawPattern("right",this.domain,this.points,!0),this.drawRight(t,this.domain,this.points,null,this.half_band),this.drawBaseLine("right",t),t.append(this.createGridY("right",this.domain.length,this.end,null,!0))},this.initDomain=function(){var t=[];if(h.typeCheck("string",this.grid.domain)){var e=this.grid.domain,i=this.data();if(this.grid.reverse)var n=i.length-1,r=0,a=-1;else n=0,r=i.length-1,a=1;for(var s=n;this.grid.reverse?r<=s:s<=r;s+=a)t.push(i[s][e])}else h.typeCheck("function",this.grid.domain)?t=this.grid.domain.call(this.chart):h.typeCheck("array",this.grid.domain)&&(t=this.grid.domain);return this.grid.reverse&&t.reverse(),t},this.wrapper=function(t,e){var i=t,n=this,r=n.domain.length,a=n.grid.reverse;return e?h.extend(function(t){return i("number"==typeof t&&e?n.axis.data[t][e]:a?r-t-1:t)},i):i},this.drawBefore=function(){var t=this.initDomain(),e=this.getGridSize(),i=[e.start,e.end];this.scale=n.ordinal().domain(t),this.scale.rangePoints(i),this.start=e.start,this.size=e.size,this.end=e.end,this.points=this.scale.range(),this.domain=this.scale.domain(),this.band=this.scale.rangeBand(),this.half_band=this.band/2,this.bar=6,this.reverse=this.grid.reverse},this.draw=function(){return this.drawGrid("block")}}var h=z.include("util.base"),n=z.include("util.scale");return t.setup=function(){return{domain:null,reverse:!1,max:10,hideText:!1,key:null}},t}},st={name:"chart.grid.date",extend:"chart.grid.core",component:function(){function t(){this.center=function(t){this.drawCenter(t,this.ticks,this.values,null,0),this.drawBaseLine("center",t)},this.top=function(t){this.drawPattern("top",this.ticks,this.values),this.drawTop(t,this.ticks,this.values,null,0),this.drawBaseLine("top",t)},this.bottom=function(t){this.drawPattern("bottom",this.ticks,this.values),this.drawBottom(t,this.ticks,this.values,null,0),this.drawBaseLine("bottom",t)},this.left=function(t){this.drawPattern("left",this.ticks,this.values),this.drawLeft(t,this.ticks,this.values,null,0),this.drawBaseLine("left",t)},this.right=function(t){this.drawPattern("right",this.ticks,this.values),this.drawRight(t,this.ticks,this.values,null,0),this.drawBaseLine("right",t)},this.wrapper=function(t,e){var i=t,n=this;return e?c.extend(function(t){return i("number"==typeof t?n.axis.data[t][e]:+t)},i):i},this.initDomain=function(){var t=[],e=[],i=this.grid.min||void 0,n=this.grid.max||void 0,r=this.data(),a=[];if(c.typeCheck("string",this.grid.domain)){if(0<r.length){var s=this.grid.domain;a.push(+r[0][s]),a.push(+r[r.length-1][s])}}else if(c.typeCheck("function",this.grid.domain))for(var h=r.length;h--;){var o=this.grid.domain.call(this.chart,r[h]);c.typeCheck("array",o)?(a[h]=Math.max.apply(Math,o),a.push(Math.min.apply(Math,o))):a[h]=o}else a=this.grid.domain;return c.typeCheck("undefined",i)&&0<a.length&&(i=Math.min.apply(Math,a)),c.typeCheck("undefined",n)&&0<a.length&&(n=Math.max.apply(Math,a)),t=[i,n],e=this.grid.interval,this.grid.reverse&&t.reverse(),c.typeCheck("function",e)?this.interval=e.call(this.chart,t):this.interval=e,t},this.drawBefore=function(){var t,e,i=this.initDomain(),n=this.getGridSize(),r=[n.start,n.end];if(this.scale=u.time().domain(i).range(r),this.scale.clamp(this.grid.clamp),this.ticks=[],null!=this.grid.realtime&&l[this.grid.realtime]==this.grid.realtime)var a=this.scale.realTicks(this.grid.realtime,this.interval);else a=this.scale.ticks("milliseconds",this.interval);"string"==typeof this.grid.format&&(t=this.grid,e=this.grid.format,t.format=function(t){return l.format(t,e)}),this.start=n.start,this.size=n.size,this.end=n.end,this.bar=6,this.values=[];for(var s=0,h=a.length;s<h;s++){var o=this.scale(a[s]);o>=n.start&&o<=n.end&&(this.values.push(o),this.ticks.push(a[s]))}},this.draw=function(){return this.drawGrid("date")}}var c=z.include("util.base"),u=z.include("util.scale"),l=z.include("util.time");return t.setup=function(){return{domain:null,interval:1e3,min:null,max:null,reverse:!1,key:null,realtime:null,hideText:!1}},t}},ht={name:"chart.grid.dateblock",extend:"chart.grid.date",component:function(){var u=z.include("util.base"),l=z.include("util.scale"),d=z.include("util.time");return function(){this.wrapper=function(t,e){var i=t,n=this;return i.rangeBand=function(){return n.grid.unit},i},this.initDomain=function(){var t=[],e=[],i=this.grid.min||void 0,n=this.grid.max||void 0,r=this.data(),a=[];if(u.typeCheck("string",this.grid.domain)){var s=this.grid.domain;a.push(+r[0][s]),a.push(+r[r.length-1][s])}else if(u.typeCheck("function",this.grid.domain))for(var h=r.length;h--;){var o=this.grid.domain.call(this.chart,r[h]);u.typeCheck("array",o)?(a[h]=+Math.max.apply(Math,o),a.push(+Math.min.apply(Math,o))):a[h]=+o}else a=this.grid.domain;return u.typeCheck("undefined",i)&&(i=Math.min.apply(Math,a)),u.typeCheck("undefined",n)&&(n=Math.max.apply(Math,a)),t=[i,n],e=this.grid.interval,this.grid.reverse&&t.reverse(),u.typeCheck("function",e)?t.interval=e.call(this.chart,t):t.interval=e,t},this.drawBefore=function(){var t=this.initDomain(),e=this.getGridSize(),i=[e.start,e.end],n=l.time().domain(t).rangeRound(i);null!=this.grid.realtime&&d[this.grid.realtime]==this.grid.realtime?this.ticks=n.realTicks(this.grid.realtime,t.interval):this.ticks=n.ticks("milliseconds",t.interval);var r,a,s=this.axis.data.length-1,h=this.grid.unit=Math.abs(i[0]-i[1])/s;"string"==typeof this.grid.format&&(r=this.grid,a=this.grid.format,r.format=function(t){return d.format(t,a)}),this.start=e.start,this.size=e.size,this.end=e.end,this.bar=6,this.values=[];var o=0;for(s=this.ticks.length;o<s;o++)this.values[o]=n(this.ticks[o]);var c=this;this.scale=u.extend(function(t){return c.start+t*h},n)},this.draw=function(){return this.drawGrid("dateblock")}}}},ot={name:"chart.grid.fullblock",extend:"chart.grid.core",component:function(){function t(){this.center=function(t){this.drawCenter(t,this.domain,this.points,null,0),this.drawBaseLine("center",t)},this.top=function(t){this.drawPattern("top",this.domain,this.points),this.drawTop(t,this.domain,this.points,null,0),this.drawBaseLine("top",t)},this.bottom=function(t){this.drawPattern("bottom",this.domain,this.points),this.drawBottom(t,this.domain,this.points,null,0),this.drawBaseLine("bottom",t)},this.left=function(t){this.drawPattern("left",this.domain,this.points),this.drawLeft(t,this.domain,this.points,null,0),this.drawBaseLine("left",t)},this.right=function(t){this.drawPattern("right",this.domain,this.points),this.drawRight(t,this.domain,this.points,null,0),this.drawBaseLine("right",t)},this.initDomain=function(){var t=[];if(h.typeCheck("string",this.grid.domain)){var e=this.grid.domain,i=this.data();if(this.grid.reverse)var n=i.length-1,r=0,a=-1;else n=0,r=i.length-1,a=1;for(var s=n;this.grid.reverse?r<=s:s<=r;s+=a)t.push(i[s][e])}else h.typeCheck("function",this.grid.domain)?t=this.grid.domain.call(this.chart):h.typeCheck("array",this.grid.domain)&&(t=this.grid.domain);return this.grid.reverse&&t.reverse(),t},this.wrapper=function(t,e){var i=t,n=this,r=n.domain.length,a=n.grid.reverse;return e?h.extend(function(t){return i("number"==typeof t&&e?n.axis.data[t][e]:a?r-t:t)},i):i},this.drawBefore=function(){var t=this.initDomain(),e=this.getGridSize();this.scale=n.ordinal().domain(t);var i=[e.start,e.end];this.scale.rangeBands(i),this.start=e.start,this.size=e.size,this.end=e.end,this.points=this.scale.range(),this.domain=this.scale.domain(),this.band=this.scale.rangeBand(),this.half_band=0,this.bar=6,this.reverse=this.grid.reverse},this.draw=function(){return this.drawGrid("fullblock")}}var h=z.include("util.base"),n=z.include("util.scale");return t.setup=function(){return{domain:null,reverse:!1,max:10,hideText:!1}},t}};z.use([f]);var ct={name:"chart.grid.radar",extend:"chart.grid.core",component:function(){function t(){var L=this,B=[];function S(t,e,i,n,r,a,s){var h=L.chart.svg.group(),o=[];o.push([e+n,i+r]);for(var c=n,u=r,l=0;l<a;l++){var d=D.rotate(c,u,s);c=d.x,u=d.y,o.push([e+d.x,i+d.y])}var f=L.chart.svg.path({fill:"none",stroke:L.color("gridBorderColor"),"stroke-width":L.chart.theme("gridBorderWidth")});for(l=0;l<o.length;l++){var p=o[l];0==l?f.MoveTo(p[0],p[1]):f.LineTo(p[0],p[1])}f.LineTo(o[0][0],o[0][1]),h.append(f),t.append(h)}function j(c){var u=L.grid.max,l=L.chart.padding("left"),d=L.chart.padding("top");return function(t,e){var i=e/u,n=(Math.abs(c.y1)-Math.abs(c.y2))*i,r=2*Math.PI/L.domain.length,a=c.x1,s=c.y1,h=-n,o=D.rotate(0,h,r*t);return{x:l+a+o.x,y:d+s+o.y}}}this.initDomain=function(){var t=[];if(h.typeCheck("string",this.grid.domain)){var e=this.grid.domain,i=this.data();if(this.grid.reverse)var n=i.length-1,r=0,a=-1;else n=0,r=i.length-1,a=1;for(var s=n;this.grid.reverse?r<=s:s<=r;s+=a)t.push(i[s][e])}else t=h.typeCheck("function",this.grid.domain)?this.grid.domain(this.chart,this.grid):this.grid.domain;return this.grid.reverse&&t.reverse(),t},this.drawBefore=function(){this.domain=this.initDomain()},this.draw=function(){var t=this.axis.area("width"),e=this.axis.area("height"),i=t;e<i&&(i=e);var n=i/2,r=this.axis.area("x")+t/2,a=this.axis.area("y")+e/2,s=-n,h=0,o=this.domain.length,c=this.grid.step,u=2*Math.PI/o,l=Math.abs(s)/c,d=this.chart.svg.group(),f=this.chart.svg.group();d.append(f),B=[];for(var p=0;p<o;p++){var g=r+h,m=a+s;f.append(this.chart.svg.line({x1:r,y1:a,x2:g,y2:m,stroke:this.color("gridAxisBorderColor"),"stroke-width":this.chart.theme("gridBorderWidth")})),B[p]={x1:r,y1:a,x2:g,y2:m};var v=m,y=g,x="middle";a<m?v=m+20:m<a&&(v=m-10),r<g?(x="start",y+=10):g<r&&(x="end",y-=10),this.grid.hideText||f.append(this.chart.text({x:y,y:v,"text-anchor":x,"font-size":this.chart.theme("gridCFontSize"),"font-weight":this.chart.theme("gridCFontWeight"),fill:this.chart.theme("gridCFontColor")},this.domain[p]));var w=D.rotate(h,s,u);h=w.x,s=w.y}if(!this.grid.line)return{root:f,scale:j(B[0])};s=-n;var b,k,C,M,T,A,F,R=0,z=this.grid.max/this.grid.step;for(p=0;p<c;p++)0==p&&this.grid.extra?s+=l:("circle"==this.grid.shape?(b=f,k=r,C=a,M=s,void 0,T=Math.abs(M),A=k,F=C,b.append(L.chart.svg.circle({cx:A,cy:F,r:T,"fill-opacity":0,stroke:L.color("gridBorderColor"),"stroke-width":L.chart.theme("gridBorderWidth")}))):S(f,r,a,0,s,o,u),this.grid.hideText||f.append(this.chart.text({x:r,y:a+(s+l-5),"font-size":this.chart.theme("gridCFontSize"),"font-weight":this.chart.theme("gridCFontWeight"),fill:this.chart.theme("gridCFontColor")},this.grid.max-R+"")),s+=l,R+=z);return this.grid.hide&&f.attr({display:"none"}),{root:f,scale:j(B[0])}}}var h=z.include("util.base"),D=z.include("util.math");return t.setup=function(){return{domain:null,reverse:!1,max:100,step:10,line:!0,hideText:!1,extra:!1,shape:"radial"}},t}};z.use([f,X]);var ut={name:"chart.grid.range",extend:"chart.grid.core",component:function(){function t(){this.center=function(t){var e=this.scale.min(),i=this.scale.max();this.drawCenter(t,this.ticks,this.values,function(t){return 0==t&&t!=e&&t!=i},0),this.drawBaseLine("center",t)},this.top=function(t){this.drawPattern("top",this.ticks,this.values);var e=this.scale.min(),i=this.scale.max();this.drawTop(t,this.ticks,this.values,function(t){return 0==t&&t!=e&&t!=i},0),this.drawBaseLine("top",t)},this.bottom=function(t){this.drawPattern("bottom",this.ticks,this.values);var e=this.scale.min(),i=this.scale.max();this.drawBottom(t,this.ticks,this.values,function(t){return 0==t&&t!=e&&t!=i},0),this.drawBaseLine("bottom",t)},this.left=function(t){this.drawPattern("left",this.ticks,this.values);var e=this.scale.min(),i=this.scale.max();this.drawLeft(t,this.ticks,this.values,function(t){return 0==t&&t!=e&&t!=i},0),this.drawBaseLine("left",t)},this.right=function(t){this.drawPattern("right",this.ticks,this.values);var e=this.scale.min(),i=this.scale.max();this.drawRight(t,this.ticks,this.values,function(t){return 0==t&&t!=e&&t!=i},0),this.drawBaseLine("right",t)},this.wrapper=function(t,e){var i=t,n=this;return e?m.extend(function(t){return i(n.axis.data[t][e])},i):i},this.initDomain=function(){var t=[],e=this.grid.min||void 0,i=this.grid.max||void 0,n=this.data(),r=[],a=!1;if(m.typeCheck("string",this.grid.domain)){var s=this.grid.domain;r=new Array(n.length);for(var h=n.length;h--;){var o=n[h][s];m.typeCheck("array",o)?(r[h]=Math.max(o),r.push(Math.min(o))):(r[h]=o,r.push(0))}}else if(m.typeCheck("function",this.grid.domain)){r=new Array(n.length);var c=!1;for(h=n.length;h--;){o=this.grid.domain.call(this.chart,n[h]);m.typeCheck("array",o)?(r[h]=Math.max.apply(Math,o),r.push(Math.min.apply(Math,o))):(r[h]=o,c||(r.push(0),c=!0))}}else r=this.grid.domain,a=!0;var u,l=Math.min.apply(Math,r),d=Math.max.apply(Math,r);if(a?(e=l,i=d):((void 0===e||l<e)&&(e=l),(void 0===i||i<d)&&(i=d)),m.typeCheck("function",this.grid.unit)?u=this.grid.unit.call(this.chart,this.grid):m.typeCheck("number",this.grid.unit)?u=this.grid.unit:(0<e&&(e=Math.floor(e)),1<(u=v.div(i-e,this.grid.step))?u=Math.ceil(u):0<u&&u<1&&(u=v.div(Math.ceil(v.multi(u,10)),10))),0==u)t=[0,0];else{for(var f=0,p=v.fixed(u);f<i;)f=p.plus(f,u);for(var g=f;e<g;)g=p.minus(g,u);(t=[g,f]).step=Math.abs(g-f)/u}return this.grid.reverse&&t.reverse(),t},this.drawBefore=function(){var t=this.initDomain(),e=this.getGridSize();if(this.scale=a.linear().domain(t),"left"==this.grid.orient||"right"==this.grid.orient)var i=[e.end,e.start];else i=[e.start,e.end];this.scale.range(i),this.scale.clamp(this.grid.clamp),this.start=e.start,this.size=e.size,this.end=e.end,this.step=t.step,this.nice=this.grid.nice,this.ticks=this.scale.ticks(this.step,this.nice),"left"!=this.grid.orient&&"right"!=this.grid.orient||this.ticks.reverse(),this.bar=6,this.values=[];for(var n=0,r=this.ticks.length;n<r;n++)this.values[n]=this.scale(this.ticks[n])},this.draw=function(){return this.drawGrid("range")}}var m=z.include("util.base"),v=z.include("util.math"),a=z.include("util.scale");return t.setup=function(){return{domain:null,step:10,min:0,max:0,unit:null,clamp:!0,reverse:!1,key:null,hideText:!1,nice:!1}},t}},lt={name:"chart.grid.log",extend:"chart.grid.range",component:function(){function t(){this.drawBefore=function(){this.grid.unit=!1;var t=this.initDomain(),e=this.getGridSize();if(this.scale=a.log(this.grid.base).domain(t),"left"==this.grid.orient||"right"==this.grid.orient)var i=[e.end,e.start];else i=[e.start,e.end];this.scale.range(i),this.start=e.start,this.size=e.size,this.end=e.end,this.step=this.grid.step,this.nice=this.grid.nice,this.ticks=this.scale.ticks(this.step,this.nice),"left"!=this.grid.orient&&"right"!=this.grid.orient||this.ticks.reverse(),this.bar=6,this.values=[];for(var n=0,r=this.ticks.length;n<r;n++)this.values[n]=this.scale(this.ticks[n])},this.draw=function(){return this.drawGrid("log")}}var a=z.include("util.scale");return t.setup=function(){return{base:10,step:4,nice:!1,hideText:!1}},t}},dt={name:"chart.grid.rule",extend:"chart.grid.core",component:function(){function t(){this.top=function(t){var e=this.axis.area("height")/2;t.append(this.axisLine({y1:this.center?e:0,y2:this.center?e:0,x1:this.start,x2:this.end}));for(var i=this.ticks,n=this.values,r=this.bar,a=0;a<i.length;a++){var s=this.format(i[a],a);if(s||0===s){var h=0==i[a],o=this.chart.svg.group().translate(n[a],this.center?e:0);o.append(this.line({y1:this.center?-r:0,y2:r,stroke:this.color("gridAxisBorderColor"),"stroke-width":this.chart.theme("gridBorderWidth")})),h&&(!h||this.hideZero)||o.append(this.getTextRotate(this.chart.text({x:0,y:r+r+4,"text-anchor":"middle",fill:this.chart.theme("gridFontColor")},s))),t.append(o)}}},this.bottom=function(t){var e=this.axis.area("height")/2;t.append(this.axisLine({y1:this.center?-e:0,y2:this.center?-e:0,x1:this.start,x2:this.end}));for(var i=this.ticks,n=this.values,r=this.bar,a=0;a<i.length;a++){var s=this.format(i[a],a);if(s||0===s){var h=0==i[a],o=this.chart.svg.group().translate(n[a],this.center?-e:0);o.append(this.line({y1:this.center?-r:0,y2:this.center?r:-r,stroke:this.color("gridAxisBorderColor"),"stroke-width":this.chart.theme("gridBorderWidth")})),h&&(!h||this.hideZero)||o.append(this.getTextRotate(this.chart.text({x:0,y:2*-r,"text-anchor":"middle",fill:this.chart.theme(h,"gridActiveFontColor","gridFontColor")},s))),t.append(o)}}},this.left=function(t){var e=this.axis.area("width"),i=(this.axis.area("height"),e/2);t.append(this.axisLine({x1:this.center?i:0,x2:this.center?i:0,y1:this.start,y2:this.end}));for(var n=this.ticks,r=this.values,a=this.bar,s=0;s<n.length;s++){var h=this.format(n[s],s);if(h||0===h){var o=0==n[s],c=this.chart.svg.group().translate(this.center?i:0,r[s]);c.append(this.line({x1:this.center?-a:0,x2:a,stroke:this.color("gridAxisBorderColor"),"stroke-width":this.chart.theme("gridBorderWidth")})),o&&(!o||this.hideZero)||c.append(this.getTextRotate(this.chart.text({x:a/2+4,y:a-2,fill:this.chart.theme("gridFontColor")},h))),t.append(c)}}},this.right=function(t){var e=this.axis.area("width")/2;t.append(this.axisLine({x1:this.center?-e:0,x2:this.center?-e:0,y1:this.start,y2:this.end}));for(var i=this.ticks,n=this.values,r=this.bar,a=0;a<i.length;a++){var s=this.format(i[a],a);if(s||0===s){var h=0==i[a],o=this.chart.svg.group().translate(this.center?-e:0,n[a]);o.append(this.line({x1:this.center?-r:0,x2:this.center?r:-r,stroke:this.color("gridAxisBorderColor"),"stroke-width":this.chart.theme("gridBorderWidth")})),h&&(!h||this.hideZero)||o.append(this.getTextRotate(this.chart.text({x:-r-4,y:r-2,"text-anchor":"end",fill:this.chart.theme("gridFontColor")},s))),t.append(o)}}},this.wrapper=function(t,e){var i=t,n=this;return e?p.extend(function(t){return i(n.axis.data[t][e])},i):i},this.initDomain=function(){var t=[],e=this.grid.min||void 0,i=this.grid.max||void 0,n=this.data(),r=[];if(p.typeCheck("string",this.grid.domain)){var a=this.grid.domain;r=new Array(n.length);for(var s=0,h=n.length;s<h;s++){var o=n[s][a];p.typeCheck("array",o)?(r[s]=Math.max(o),r.push(Math.min(o))):r[s]=o}}else if(p.typeCheck("function",this.grid.domain)){r=new Array(n.length);for(s=0,h=n.length;s<h;s++){o=this.grid.domain.call(this.chart,n[s]);p.typeCheck("array",o)?(r[s]=Math.max.apply(Math,o),r.push(Math.min.apply(Math,o))):r[s]=o}}else r=grid.domain;var c,u=Math.min.apply(Math,r),l=Math.max.apply(Math,r);if(void 0===e&&(e=u),void 0===i&&(i=l),this.grid.max=i,this.grid.min=e,0==(c=p.typeCheck("function",this.grid.unit)?this.grid.unit.call(this.chart,this.grid):p.typeCheck("number",this.grid.unit)?this.grid.unit:Math.ceil((i-e)/this.grid.step)))t=[0,0];else{for(var d=0;d<i;)d+=c;for(var f=d;e<f;)f-=c;t=[f,d]}return this.grid.reverse&&t.reverse(),t},this.drawBefore=function(){var t=this.initDomain(),e=this.getGridSize();if(this.scale=a.linear().domain(t),"left"==this.grid.orient||"right"==this.grid.orient)var i=[e.end,e.start];else i=[e.start,e.end];this.scale.range(i),this.start=e.start,this.size=e.size,this.end=e.end,this.step=this.grid.step,this.nice=this.grid.nice,this.ticks=this.scale.ticks(this.step,this.nice),this.bar=6,this.hideZero=this.grid.hideZero,this.center=this.grid.center,this.values=[];for(var n=0,r=this.ticks.length;n<r;n++)this.values[n]=this.scale(this.ticks[n])},this.draw=function(){return this.drawGrid(chart,orient,"rule",grid)}}var p=z.include("util.base"),a=z.include("util.scale");return t.setup=function(){return{domain:null,step:10,min:0,max:0,unit:null,clamp:!0,reverse:!1,key:null,hideText:!1,hideZero:!1,nice:!1,center:!1}},t}},ft={name:"chart.grid.panel",extend:"chart.grid.core",component:function(){var i=z.include("util.base");return function(){this.custom=function(t){var e=this.scale(0);e.x-=this.axis.area("x"),e.y-=this.axis.area("y"),t.append(this.chart.svg.rect(i.extend(e,{fill:"transparent",stroke:"transparent"})))},this.drawBefore=function(){var e;this.scale=(e=this.axis,function(t){return{x:e.area("x"),y:e.area("y"),width:e.area("width"),height:e.area("height")}})},this.draw=function(){return this.grid.hide=!0,this.drawGrid("panel")}}}},pt={name:"chart.grid.table",extend:"chart.grid.core",component:function(){function t(){this.custom=function(t){for(var e=0;e<void 0;e++)for(var i=0;i<void 0;i++){var n=void 0*e+i,r=this.scale(n);r.x-=this.axis.area("x"),r.y-=this.axis.area("y");this.chart.svg.rect(_.extend(r,{fill:"tranparent",stroke:"black"}))}},this.drawBefore=function(){var h,o,c,u,t=this.grid.rows,e=this.grid.columns,l=this.grid.padding,i=(this.axis.area("width")-(e-1)*l)/e,n=(this.axis.area("height")-(t-1)*l)/t;this.scale=(h=this.axis,o=e,c=n,u=i,function(t){var e=Math.floor(t/o),i=t%o,n=i*u,r=e*c,a=l*i,s=l*e;return{x:h.area("x")+n+a,y:h.area("y")+r+s,width:u,height:c}})},this.draw=function(){return this.grid.hide=!0,this.drawGrid("table")}}return t.setup=function(){return{rows:1,columns:1,padding:10}},t}},gt={name:"chart.grid.overlap",extend:"chart.grid.core",component:function(){function t(){var t,r,a,s,h;this.custom=function(){for(var t=0,e=this.axis.data.length;t<e;t++){var i=this.scale(t);i.x-=this.axis.area("x"),i.y-=this.axis.area("y"),this.chart.svg.rect(n.extend(i,{fill:"transparent",stroke:"transparent"}))}},this.drawBefore=function(){var n;t=this.grid.count||this.axis.data.length||1,r=this.axis.area("width")/2/t,a=this.axis.area("height")/2/t,s=this.axis.area("width"),h=this.axis.area("height"),this.scale=(n=this.axis,function(t){var e=t*r,i=t*a;return{x:n.area("x")+e,y:n.area("y")+i,width:2*Math.abs(s/2-e),height:2*Math.abs(h/2-i)}})},this.draw=function(){return this.grid.hide=!0,this.drawGrid("overlap")}}var n=z.include("util.base");return t.setup=function(){return{count:null}},t}};z.use([f]);var mt={name:"chart.grid.grid3d",extend:"chart.grid.core",component:function(){function t(){var o=this,c=0,t=0,u=0;function h(t){var i=null;return t.each(function(t,e){"line"==e.element.nodeName&&(i=e.attributes)}),i}this.drawBefore=function(){c=this.axis.get("depth"),t=this.axis.get("degree"),u=e.radian(360-t),this.scale=(this.axis,function(t,e,i,n){var r=l.typeCheck("integer",n)?n:1,a=c/r;if(null==i||1==r)return{x:o.axis.x(t),y:o.axis.y(e),depth:a};var s=a*(i=null==i?0:i),h=Math.sin(u)*a;return{x:o.axis.x(t)+Math.cos(u)*s,y:o.axis.y(e)+Math.sin(u)*s+h,depth:a}}),this.scale.depth=c,this.scale.degree=t,this.scale.radian=u},this.draw=function(){var n=this.axis.x.root,s=this.axis.y.root,r=Math.sin(u)*c,a=Math.cos(u)*c;return s.each(function(t,e){if("line"==e.element.nodeName)s.append(o.line({x1:a,y1:0,x2:a,y2:r+e.attributes.y2}));else{var i=h(n);e.append(o.line({x1:0,y1:0,x2:a,y2:r})),e.append(o.line({x1:a,y1:r,x2:a+i.x2,y2:r}))}}),n.each(function(t,e){var i="line"==e.element.nodeName?e.attributes:e.get(0).attributes,n=i.y1+Math.sin(u)*c,r=i.x1+Math.cos(u)*c;if(0<t){var a=h(s);e.append(o.line({x1:i.x1,y1:i.y1,x2:r,y2:n})),e.append(o.line({x1:r,y1:n,x2:r,y2:-(a.y2-n)}))}}),this.drawGrid()}}var l=z.include("util.base"),e=z.include("util.math");return t.setup=function(){return{domain:null}},t}};z.use(G,t);var vt={name:"chart.brush.core",extend:"chart.draw",component:function(){function t(){this.drawAfter=function(t){!1!==this.brush.clip&&t.attr({"clip-path":"url(#"+this.axis.get("clipId")+")"}),t.attr({class:"brush-"+this.brush.type}),t.translate(this.chart.area("x"),this.chart.area("y"))},this.drawTooltip=function(t,e,i){var n=this,a=null;return{tooltip:a=n.chart.svg.group({visibility:"hidden"},function(){n.chart.text({fill:n.chart.theme("tooltipPointFontColor"),"font-size":n.chart.theme("tooltipPointFontSize"),"font-weight":n.chart.theme("tooltipPointFontWeight"),"text-anchor":"middle",opacity:i}),n.chart.svg.circle({r:n.chart.theme("tooltipPointRadius"),fill:t,stroke:e,opacity:i,"stroke-width":n.chart.theme("tooltipPointBorderWidth")})}),control:function(t,e,i,n){var r=a.get(0);r.element.textContent=n,"left"==t?r.attr({x:-7,y:4,"text-anchor":"end"}):"right"==t?r.attr({x:7,y:4,"text-anchor":"start"}):"bottom"==t?r.attr({y:16}):r.attr({y:-7}),a.attr({visibility:0!=n?"visible":"hidden"}),a.translate(e,i)},style:function(t,e,i){a.get(0).attr({opacity:i}),a.get(1).attr({fill:t,stroke:e,opacity:i})}}},this.curvePoints=function(t){var e=[],i=[],n=t.length-1,r=[],a=[],s=[],h=[];for(a[r[0]=0]=2,s[0]=1,h[0]=t[0]+2*t[1],o=1;o<n-1;o++)r[o]=1,a[o]=4,s[o]=1,h[o]=4*t[o]+2*t[o+1];r[n-1]=2,a[n-1]=7,s[n-1]=0,h[n-1]=8*t[n-1]+t[n];for(var o=1;o<n;o++){var c=r[o]/a[o-1];a[o]=a[o]-c*s[o-1],h[o]=h[o]-c*h[o-1]}e[n-1]=h[n-1]/a[n-1];for(o=n-2;0<=o;--o)e[o]=(h[o]-s[o]*e[o+1])/a[o];for(o=0;o<n-1;o++)i[o]=2*t[o+1]-e[o+1];return i[n-1]=.5*(t[n]+e[n-1]),{p1:e,p2:i}},this.eachData=function(t,e){if(h.typeCheck("function",t)){var i=this.listData();if(!0===e)for(var n=i.length-1;0<=n;n--)t.call(this,n,i[n]);else{var r=0;for(n=i.length;r<n;r++)t.call(this,i[r],r)}}},this.listData=function(){return this.axis&&this.axis.data?this.axis.data:[]},this.getData=function(t){return this.listData()[t]},this.getValue=function(t,e,i){return this.axis.getValue(t,e,i)},this.getXY=function(o){var c=[],u={},t=this.listData().length,e=t,l=this.brush.target,d=l.length;!1!==o&&(u=function(t,e){for(var i={},n={},r=0;r<e.length;r++)i[e[r]]||(n[e[r]]=[]);r=0;for(var a=t.length;r<a;r++){var s=t[r];for(var h in n)n[h].push(s[h])}for(var o in n)i[o]={min:Math.min.apply(Math,n[o]),max:Math.max.apply(Math,n[o])};return i}(this.axis.data,l));for(var i=0;i<d;i++)c[i]={x:new Array(t),y:new Array(t),value:new Array(t),min:[],max:[],length:t};var f=this.axis.data,p="range"==this.axis.y.type,g=this.axis.x,m=this.axis.y;return h.loop(e)(function(t,e){var i=f[t],n=0,r=0;p?n=g(t):r=m(t);for(var a=0;a<d;a++){var s=l[a],h=i[s];p?r=m(h):n=g(h),c[a].x[t]=n,c[a].y[t]=r,c[a].value[t]=h,!1!==o&&(c[a].min[t]=h==u[s].min,c[a].max[t]=h==u[s].max)}}),c},this.getStackXY=function(t){var a=this.getXY(t),s="range"==this.axis.y.type;return this.eachData(function(t,e){for(var i=0,n=0;n<this.brush.target.length;n++){var r=t[this.brush.target[n]];0<n&&(i+=t[this.brush.target[n-1]]),s?a[n].y[e]=this.axis.y(r+i):a[n].x[e]=this.axis.x(r+i)}}),a},this.addEvent=function(t,e,i){if(!0===this.brush.useEvent){var r=this.chart,n={};h.typeCheck("object",e)&&!i?(n.brush=this.brush,n.data=e):(n.brush=this.brush,n.dataIndex=e,n.dataKey=null!=i?this.brush.target[i]:null,n.data=null!=e?this.getData(e):null),t.on("click",function(t){a(t),r.emit("click",[n,t])}),t.on("dblclick",function(t){a(t),r.emit("dblclick",[n,t])}),t.on("contextmenu",function(t){a(t),r.emit("rclick",[n,t]),t.preventDefault()}),t.on("mouseover",function(t){a(t),r.emit("mouseover",[n,t])}),t.on("mouseout",function(t){a(t),r.emit("mouseout",[n,t])}),t.on("mousemove",function(t){a(t),r.emit("mousemove",[n,t])}),t.on("mousedown",function(t){a(t),r.emit("mousedown",[n,t])}),t.on("mouseup",function(t){a(t),r.emit("mouseup",[n,t])})}function a(t){var e=s.offset(r.root),i=t.pageX-e.left,n=t.pageY-e.top;t.bgX=i,t.bgY=n,t.chartX=i-r.padding("left"),t.chartY=n-r.padding("top")}},this.color=function(t,e){var i=this.brush.colors,n=null,r=0,a=0;if(h.typeCheck("undefined",e)?r=t:(r=e,a=t),h.typeCheck("function",i)){var s=i.call(this.chart,this.getData(a),a);n=h.typeCheck(["string","integer"],s)?this.chart.color(s):h.typeCheck("array",s)?this.chart.color(r,s):this.chart.color(0)}else n=this.chart.color(r,i);return n},this.offset=function(t,e){var i=this.axis[t](e);return"block"!=this.axis[t].type&&(i+=this.axis[t].rangeBand()/2),i}}var h=z.include("util.base"),s=z.include("util.dom");return t.setup=function(){return{target:null,colors:null,axis:0,index:null,clip:!0,useEvent:!0}},t}},yt={name:"chart.brush.canvas.core",extend:"chart.brush.core",component:function(){var r=z.include("util.base");return function(){this.addPolygon=function(t,e){r.typeCheck("array",this.polygons)||(this.polygons=[]),this.calculate3d(t),this.polygons.push({polygon:t,order:this.axis.depth-t.max().z,handler:e})},this.drawAfter=function(){if(r.typeCheck("array",this.polygons)){var t=this.polygons;t.sort(function(t,e){return t.order-e.order});for(var e=0,i=t.length;e<i;e++){var n=t.shift();n.handler.call(this,n.polygon)}}}}}};z.use(G);var xt={name:"chart.widget.core",extend:"chart.draw",component:function(){function t(){this.getIndexArray=function(t){var e=[0];return s.typeCheck("array",t)?e=t:s.typeCheck("integer",t)&&(e=[t]),e},this.getScaleToValue=function(t,e,i,n,r){var a=r-(t-e)/.1*((r-n)/(10*(i-e)));return a<n?n:r<a?r:a},this.getValueToScale=function(t,e,i,n,r){return parseFloat((n+(i-t)/((i-e)/(10*(r-n)))*.1).toFixed(1))},this.isRender=function(){return!0===this.widget.render},this.on=function(i,n,r){var a=this;return this.chart.on(i,function(){if(s.startsWith(i,"axis.")&&s.typeCheck("integer",r)){var t=a.chart.axis(r),e=arguments[0];s.typeCheck("object",t)&&arguments[1]==r&&n.apply(a,[e])}else n.apply(a,arguments)},this.isRender()?"render":"renderAll")},this.drawAfter=function(t){t.attr({class:"widget-"+this.widget.type})}}var s=z.include("util.base");return t.setup=function(){return{render:!1,index:0}},t}};z.use([t,f,p,g,m,v,y,b,k,A,F,R,L,B,S,j,D,I,P,E,{name:"util.scale.circle",extend:null,component:function(){return function(){var h=[],o=[],c=0;function u(t){}return u.domain=function(t){if(void 0===t)return h;for(var e=0;e<t.length;e++)h[e]=t[e];return this},u.range=function(t){if(void 0===t)return o;for(var e=0;e<t.length;e++)o[e]=t[e];return this},u.rangePoints=function(t,e){e=e||0;for(var i=h.length,n=(t[1]-t[0]-e)/i,r=[],a=0;a<h.length;a++)r[a]=0==a?t[0]+e/2+n/2:r[a-1]+n;return o=r,c=n,u},u.rangeBands=function(t,e,i){for(var n=h.length-1,r=(t[1]-t[0])/n,a=[],s=0;s<h.length;s++)a[s]=0==s?t[0]:r+a[s-1];return c=r,o=a,u},u.rangeBand=function(){return c},u}}},O,Y,W,X,N,G,U,H,V,J,q,Z,K,Q,tt,et,it,nt,rt,at,st,ht,ot,ct,ut,lt,dt,ft,pt,gt,mt,vt,{name:"chart.brush.map.core",extend:"chart.brush.core",component:function(){return function(){}}},{name:"chart.brush.polygon.core",extend:"chart.brush.core",component:function(){function t(){this.createPolygon=function(t,e){this.calculate3d(t);var i=e.call(this,t);if(i)return i.order=this.axis.depth-t.max().z,i}}return t.setup=function(){return{id:null,clip:!1}},t}},yt,xt,{name:"chart.widget.map.core",extend:"chart.widget.core",component:function(){function t(){}return t.setup=function(){return{axis:0}},t}},{name:"chart.widget.polygon.core",extend:"chart.widget.core",component:function(){return function(){this.drawAfter=function(t){}}}},{name:"chart.widget.canvas.core",extend:"chart.widget.core",component:function(){return function(){this.drawAfter=function(t){}}}}]);var wt=z.include("util.base"),bt=z.include("manager");return wt.extend(z,bt,!0),z}();
